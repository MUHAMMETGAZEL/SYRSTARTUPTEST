<!--
<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>خريطة منظومة الابتكار في سوريا - Startup Syria</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        body {
            background: linear-gradient(135deg, #0d1b2a 0%, #1b263b 100%);
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            padding: 20px;
            color: #fff;
            overflow-x: hidden;
        }
        
        .header {
            text-align: center;
            margin-bottom: 20px;
            padding: 20px;
            background: rgba(255, 255, 255, 0.05);
            border-radius: 15px;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
            position: relative;
            overflow: hidden;
            border: 1px solid rgba(76, 161, 175, 0.3);
            max-width: 1200px;
            margin-left: auto;
            margin-right: auto;
        }
        
        .header::before {
            content: "";
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 4px;
            background: linear-gradient(90deg, #ff7e5f, #feb47b, #4ca1af, #2c3e50, #9d4edd);
        }
        
        .header h1 {
            color: #fff;
            font-size: 2.5rem;
            margin-bottom: 10px;
            font-weight: 700;
            text-shadow: 0 0 15px rgba(76, 161, 175, 0.7);
        }
        
        .header h2 {
            color: #4ca1af;
            font-size: 1.8rem;
            margin-bottom: 15px;
            font-weight: 600;
        }
        
        .header p {
            color: #a8dadc;
            font-size: 1.1rem;
            max-width: 800px;
            margin: 0 auto;
            line-height: 1.6;
        }
        
        .map-container {
            display: flex;
            justify-content: center;
            align-items: center;
            flex: 1;
            position: relative;
            margin: 30px auto;
            max-width: 1200px;
            width: 100%;
            height: 85vh;
            background: rgba(0, 0, 0, 0.2);
            border-radius: 15px;
            overflow: hidden;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.4);
            border: 1px solid rgba(76, 161, 175, 0.3);
        }
        
        #flourish-container {
            width: 100%;
            height: 100%;
            overflow: hidden;
            position: relative;
        }
        
        .flourish-embed {
            width: 100%;
            height: 100%;
            border: none;
            transform-origin: center;
            transition: transform 0.3s ease;
        }
        
        .legend {
            position: absolute;
            bottom: 20px;
            left: 20px;
            background: rgba(20, 30, 50, 0.8);
            padding: 15px;
            border-radius: 10px;
            box-shadow: 0 5px 20px rgba(0, 0, 0, 0.4);
            z-index: 10;
            border: 1px solid rgba(76, 161, 175, 0.5);
        }
        
        .legend h3 {
            color: #ffd166;
            margin-bottom: 10px;
            text-align: center;
            font-size: 1.3rem;
        }
        
        .legend-item {
            display: flex;
            align-items: center;
            margin-bottom: 8px;
        }
        
        .legend-color {
            width: 20px;
            height: 20px;
            border-radius: 50%;
            margin-left: 10px;
            border: 2px solid rgba(255, 255, 255, 0.3);
        }
        
        .legend-text {
            font-size: 1rem;
            color: #a8dadc;
        }
        
        .footer {
            text-align: center;
            margin-top: 20px;
            padding: 20px;
            background: rgba(255, 255, 255, 0.05);
            border-radius: 15px;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.3);
            color: #a8dadc;
            font-size: 1.1rem;
            border: 1px solid rgba(76, 161, 175, 0.3);
            max-width: 1200px;
            margin-left: auto;
            margin-right: auto;
        }
        
        .highlight {
            color: #4ca1af;
            font-weight: 600;
            text-shadow: 0 0 8px rgba(76, 161, 175, 0.7);
        }
        
        .title-row {
            display: flex;
            justify-content: space-between;
            width: 100%;
            max-width: 1200px;
            margin: 0 auto 20px;
        }
        
        .title-box {
            background: rgba(255, 255, 255, 0.1);
            padding: 10px 20px;
            border-radius: 8px;
            font-size: 1.2rem;
            font-weight: 600;
            color: #a8dadc;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .title-box i {
            font-size: 1.4rem;
        }
        
        .controls {
            display: flex;
            justify-content: center;
            gap: 15px;
            margin-bottom: 20px;
            flex-wrap: wrap;
        }
        
        .control-btn {
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid #4ca1af;
            color: #a8dadc;
            padding: 10px 20px;
            border-radius: 30px;
            cursor: pointer;
            font-size: 1rem;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .control-btn:hover {
            background: rgba(76, 161, 175, 0.3);
            transform: translateY(-2px);
            box-shadow: 0 0 10px rgba(76, 161, 175, 0.5);
        }
        
        .statistics {
            display: flex;
            justify-content: center;
            gap: 20px;
            margin-top: 20px;
            flex-wrap: wrap;
        }
        
        .stat-box {
            background: rgba(255, 255, 255, 0.05);
            padding: 15px;
            border-radius: 10px;
            min-width: 150px;
            text-align: center;
            border: 1px solid rgba(76, 161, 175, 0.3);
            transition: all 0.3s ease;
        }
        
        .stat-box:hover {
            transform: translateY(-5px);
            box-shadow: 0 5px 15px rgba(76, 161, 175, 0.3);
        }
        
        .stat-value {
            font-size: 2rem;
            font-weight: bold;
            color: #4ca1af;
            margin-bottom: 5px;
            text-shadow: 0 0 10px rgba(76, 161, 175, 0.5);
        }
        
        .stat-label {
            font-size: 0.9rem;
            color: #a8dadc;
        }
        
        .description {
            max-width: 1200px;
            margin: 20px auto;
            padding: 20px;
            background: rgba(255, 255, 255, 0.05);
            border-radius: 15px;
            text-align: center;
            color: #a8dadc;
            line-height: 1.6;
        }
        
        .loading-overlay {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(13, 27, 42, 0.8);
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            z-index: 20;
            transition: opacity 0.5s ease;
        }
        
        .loader {
            width: 48px;
            height: 48px;
            border: 5px solid #4ca1af;
            border-bottom-color: transparent;
            border-radius: 50%;
            display: inline-block;
            animation: rotation 1s linear infinite;
        }
        
        @keyframes rotation {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        .loading-text {
            margin-top: 20px;
            font-size: 1.2rem;
            color: #a8dadc;
        }
        
        .zoom-level {
            position: absolute;
            top: 20px;
            left: 50%;
            transform: translateX(-50%);
            background: rgba(20, 30, 50, 0.8);
            padding: 10px 20px;
            border-radius: 30px;
            font-size: 1.1rem;
            color: #ffd166;
            z-index: 10;
            display: none;
            animation: fadeInOut 2s ease;
        }
        
        @keyframes fadeInOut {
            0% { opacity: 0; }
            20% { opacity: 1; }
            80% { opacity: 1; }
            100% { opacity: 0; }
        }
        
        @media (max-width: 768px) {
            .header h1 {
                font-size: 2rem;
            }
            
            .header h2 {
                font-size: 1.5rem;
            }
            
            .header p {
                font-size: 1rem;
            }
            
            .map-container {
                height: 75vh;
            }
            
            .title-box {
                font-size: 1rem;
                padding: 8px 15px;
            }
            
            .legend {
                bottom: 10px;
                left: 10px;
                padding: 10px;
                font-size: 0.9rem;
            }
        }
        
        @media (max-width: 480px) {
            .map-container {
                height: 65vh;
            }
            
            .legend {
                position: relative;
                width: 90%;
                margin: 10px auto;
                bottom: auto;
                left: auto;
            }
            
            .controls {
                flex-direction: column;
                align-items: center;
            }
            
            .control-btn {
                width: 90%;
            }
            
            .title-row {
                flex-direction: column;
                gap: 10px;
            }
            
            .header {
                padding: 15px;
            }
            
            .header h1 {
                font-size: 1.8rem;
            }
            
            .header h2 {
                font-size: 1.3rem;
            }
        }
        
        .tooltip {
            position: absolute;
            background: rgba(20, 30, 50, 0.95);
            color: white;
            padding: 15px;
            border-radius: 10px;
            pointer-events: none;
            font-size: 1.1rem;
            border: 1px solid #4ca1af;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.5);
            opacity: 0;
            transition: opacity 0.3s;
            max-width: 300px;
            z-index: 1000;
            backdrop-filter: blur(5px);
        }
    </style>
</head>
<body>
    <div class="title-row">
        <div class="title-box">
            <i class="fas fa-question-circle"></i>
            <span>Question Support</span>
        </div>
        <div class="title-box">
            <i class="fas fa-flag"></i>
            <span>Strategy Syria</span>
        </div>
    </div>
    
    <div class="header">
        <h1>خريطة منظومة الابتكار في سوريا</h1>
        <h2>Startup Syria</h2>
        <p>تم تحديث الخريطة باستخدام منصة Flourish المتقدمة لتقديم تجربة تفاعلية متكاملة</p>
    </div>
    
    <div class="controls">
        <button class="control-btn" id="fullscreen-btn">
            <i class="fas fa-expand"></i>
            <span>عرض كامل الشاشة</span>
        </button>
        <button class="control-btn" id="reset-view">
            <i class="fas fa-sync-alt"></i>
            <span>إعادة تعيين العرض</span>
        </button>
        <button class="control-btn" id="zoom-in-btn">
            <i class="fas fa-search-plus"></i>
            <span>تكبير</span>
        </button>
        <button class="control-btn" id="zoom-out-btn">
            <i class="fas fa-search-minus"></i>
            <span>تصغير</span>
        </button>
    </div>
    
    <div class="map-container">
        <div class="loading-overlay" id="loading-overlay">
            <div class="loader"></div>
            <div class="loading-text">جاري تحميل الخريطة التفاعلية...</div>
        </div>
        <div class="tooltip"></div>
        <div class="zoom-level" id="zoom-level">التكبير: 100%</div>
        
        

        <div id="flourish-container">
            <div class="flourish-embed flourish-hierarchy" data-src="visualisation/24076143">
                <script src="https://public.flourish.studio/resources/embed.js"></script>
            </div>
        </div>
    </div>
    
    <div class="description">
        <p>تقدم هذه الخريطة التفاعلية رؤية شاملة لمنظومة الابتكار في سوريا، حيث يمكنك استكشاف مختلف المكونات والعلاقات بين الجهات الفاعلة في النظام البيئي للابتكار. استخدم أدوات التحكم للتفاعل مع الخريطة واستكشاف البيانات.</p>
    </div>
    
    <div class="statistics">
        <div class="stat-box">
            <div class="stat-value">42</div>
            <div class="stat-label">منظمة داعمة</div>
        </div>
        <div class="stat-box">
            <div class="stat-value">18</div>
            <div class="stat-label">حاضنة أعمال</div>
        </div>
        <div class="stat-box">
            <div class="stat-value">127</div>
            <div class="stat-label">مشروع ناشئ</div>
        </div>
        <div class="stat-box">
            <div class="stat-value">$5.2M</div>
            <div class="stat-label">استثمارات</div>
        </div>
    </div>
    
    <div class="footer">
        <p>Source: <span class="highlight">Data Collected by Startup Syria 2025</span> | Powered by <span class="highlight">Flourish Studio</span></p>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            const mapContainer = document.querySelector('.map-container');
            const loadingOverlay = document.getElementById('loading-overlay');
            const tooltip = document.querySelector('.tooltip');
            const zoomLevel = document.getElementById('zoom-level');
            const flourishContainer = document.getElementById('flourish-container');
            const flourishEmbed = document.querySelector('.flourish-embed');
            
            // إخفاء شاشة التحميل بعد تأكيد تحميل الخريطة
            setTimeout(() => {
                loadingOverlay.style.opacity = '0';
                setTimeout(() => {
                    loadingOverlay.style.display = 'none';
                }, 500);
            }, 2000);
            
            // Fullscreen button functionality
            document.getElementById('fullscreen-btn').addEventListener('click', function() {
                if (mapContainer.requestFullscreen) {
                    mapContainer.requestFullscreen();
                } else if (mapContainer.mozRequestFullScreen) { // Firefox
                    mapContainer.mozRequestFullScreen();
                } else if (mapContainer.webkitRequestFullscreen) { // Chrome, Safari and Opera
                    mapContainer.webkitRequestFullscreen();
                } else if (mapContainer.msRequestFullscreen) { // IE/Edge
                    mapContainer.msRequestFullscreen();
                }
            });
            
            // Reset view button functionality
            document.getElementById('reset-view').addEventListener('click', function() {
                // إعادة تحميل الخريطة
                loadingOverlay.style.display = 'flex';
                loadingOverlay.style.opacity = '1';
                
                // إعادة تعيين التكبير
                flourishEmbed.style.transform = 'scale(1)';
                
                // تحديث مستوى التكبير
                zoomLevel.textContent = 'التكبير: 100%';
                zoomLevel.style.display = 'block';
                
                setTimeout(() => {
                    loadingOverlay.style.opacity = '0';
                    setTimeout(() => {
                        loadingOverlay.style.display = 'none';
                    }, 500);
                    
                    // إخفاء مستوى التكبير بعد 2 ثانية
                    setTimeout(() => {
                        zoomLevel.style.display = 'none';
                    }, 2000);
                }, 1000);
            });
            
            // Zoom in button functionality
            document.getElementById('zoom-in-btn').addEventListener('click', function() {
                let currentScale = parseFloat(flourishEmbed.style.transform.replace('scale(', '').replace(')', '')) || 1;
                if (currentScale < 2) {
                    currentScale += 0.1;
                    flourishEmbed.style.transform = `scale(${currentScale})`;
                    
                    // تحديث مستوى التكبير
                    zoomLevel.textContent = `التكبير: ${Math.round(currentScale * 100)}%`;
                    zoomLevel.style.display = 'block';
                    
                    // إخفاء مستوى التكبير بعد 2 ثانية
                    setTimeout(() => {
                        zoomLevel.style.display = 'none';
                    }, 2000);
                } else {
                    tooltip.innerHTML = '<strong>الحد الأقصى للتكبير</strong><br>لا يمكن التكبير أكثر من ذلك';
                    tooltip.style.opacity = 1;
                    tooltip.style.left = '50%';
                    tooltip.style.top = '50%';
                    tooltip.style.transform = 'translate(-50%, -50%)';
                    
                    setTimeout(() => {
                        tooltip.style.opacity = 0;
                    }, 1500);
                }
            });
            
            // Zoom out button functionality
            document.getElementById('zoom-out-btn').addEventListener('click', function() {
                let currentScale = parseFloat(flourishEmbed.style.transform.replace('scale(', '').replace(')', '')) || 1;
                if (currentScale > 0.5) {
                    currentScale -= 0.1;
                    flourishEmbed.style.transform = `scale(${currentScale})`;
                    
                    // تحديث مستوى التكبير
                    zoomLevel.textContent = `التكبير: ${Math.round(currentScale * 100)}%`;
                    zoomLevel.style.display = 'block';
                    
                    // إخفاء مستوى التكبير بعد 2 ثانية
                    setTimeout(() => {
                        zoomLevel.style.display = 'none';
                    }, 2000);
                } else {
                    tooltip.innerHTML = '<strong>الحد الأدنى للتصغير</strong><br>لا يمكن التصغير أكثر من ذلك';
                    tooltip.style.opacity = 1;
                    tooltip.style.left = '50%';
                    tooltip.style.top = '50%';
                    tooltip.style.transform = 'translate(-50%, -50%)';
                    
                    setTimeout(() => {
                        tooltip.style.opacity = 0;
                    }, 1500);
                }
            });
            
            // Initialize tooltip position on mouse move
            document.addEventListener('mousemove', function(e) {
                if (tooltip.style.opacity === '1') {
                    tooltip.style.left = (e.pageX + 10) + 'px';
                    tooltip.style.top = (e.pageY - 30) + 'px';
                }
            });
            
            // إضافة تكبير/تصغير بالماوس
            flourishContainer.addEventListener('wheel', function(e) {
                e.preventDefault();
                let currentScale = parseFloat(flourishEmbed.style.transform.replace('scale(', '').replace(')', '')) || 1;
                
                if (e.deltaY < 0) {
                    // تكبير
                    if (currentScale < 2) {
                        currentScale += 0.1;
                        flourishEmbed.style.transform = `scale(${currentScale})`;
                    }
                } else {
                    // تصغير
                    if (currentScale > 0.5) {
                        currentScale -= 0.1;
                        flourishEmbed.style.transform = `scale(${currentScale})`;
                    }
                }
                
                // تحديث مستوى التكبير
                zoomLevel.textContent = `التكبير: ${Math.round(currentScale * 100)}%`;
                zoomLevel.style.display = 'block';
                
                // إخفاء مستوى التكبير بعد 2 ثانية
                setTimeout(() => {
                    zoomLevel.style.display = 'none';
                }, 2000);
            });
        });
    </script>
</body>
</html>


-->

<!--

<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>خريطة منظومة الابتكار في سوريا - Startup Syria</title>
    <script src="https://d3js.org/d3.v7.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/crypto-js/4.1.1/crypto-js.min.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.1/firebase-database-compat.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        /* أنماط الانتقال الجديدة فقط */
        #concentric-map {
            transition: all 1s cubic-bezier(0.68, -0.55, 0.27, 1.55);
            transform-origin: center;
        }
        
        .transition-overlay {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(13, 27, 42, 0.8);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 1000;
            opacity: 0;
            pointer-events: none;
            transition: opacity 0.5s;
        }
        
        .transition-overlay.active {
            opacity: 1;
            pointer-events: all;
        }
        
        .transition-content {
            text-align: center;
            color: #ffd166;
            font-size: 2rem;
            font-weight: bold;
            text-shadow: 0 0 15px rgba(255, 209, 102, 0.7);
        }
        
        .transition-spinner {
            width: 60px;
            height: 60px;
            border: 5px solid rgba(76, 161, 175, 0.3);
            border-top: 5px solid #4ca1af;
            border-radius: 50%;
            margin: 20px auto;
            animation: spin 1s linear infinite;
        }
        
        .zoom-out {
            animation: zoomOut 0.8s forwards;
        }
        
        .zoom-in {
            animation: zoomIn 0.8s forwards;
        }
        
        @keyframes zoomOut {
            0% {
                transform: scale(1);
                opacity: 1;
            }
            50% {
                transform: scale(0.1);
                opacity: 0.3;
            }
            100% {
                transform: scale(0);
                opacity: 0;
            }
        }
        
        @keyframes zoomIn {
            0% {
                transform: scale(0);
                opacity: 0;
            }
            50% {
                transform: scale(0.1);
                opacity: 0.3;
            }
            100% {
                transform: scale(1);
                opacity: 1;
            }
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        /* بقية الأنماط الأصلية بدون تعديل */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        body {
            background: linear-gradient(135deg, #3d8c99 0%, #1b263b 100%);
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            padding: 20px;
            color: #fff;
            overflow-x: hidden;
        }
        
        .header {
            text-align: center;
            margin-bottom: 20px;
            padding: 20px;
            background: rgba(255, 255, 255, 0.05);
            border-radius: 15px;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
            position: relative;
            overflow: hidden;
            border: 1px solid rgba(76, 161, 175, 0.3);
            max-width: 800px;
            margin-left: auto;
            margin-right: auto;
        }
        
        .header::before {
            content: "";
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 4px;
            background: linear-gradient(90deg, #ff7e5f, #feb47b, #4ca1af, #2c3e50, #9d4edd);
        }
        
        .header h1 {
            color: #fff;
            font-size: 2.5rem;
            margin-bottom: 10px;
            font-weight: 700;
            text-shadow: 0 0 15px rgba(76, 161, 175, 0.7);
        }
        
        .header h2 {
            color: #4ca1af;
            font-size: 1.8rem;
            margin-bottom: 15px;
            font-weight: 600;
        }
        
        .header p {
            color: #a8dadc;
            font-size: 1.1rem;
            max-width: 800px;
            margin: 0 auto;
            line-height: 1.6;
        }
        
        .map-container {
            display: flex;
            justify-content: center;
            align-items: center;
            flex: 1;
            position: relative;
            margin: 30px auto;
            max-width: 800px;
            width: 100%;
            height: 80vh;
            perspective: 1000px;
        }
        
        #concentric-map {
            width: 100%;
            height: 100%;
            position: relative;
        }
        
        .center-circle {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 155px;
            height: 157px;
            background: radial-gradient(circle, #4ca1af, #2c3e50);
            border-radius: 50%;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            color: white;
            font-weight: bold;
            text-align: center;
            box-shadow: 
                0 0 30px rgba(76, 161, 175, 0.8),
                inset 0 0 20px rgba(0, 0, 0, 0.3);
            border: 3px solid rgba(255, 255, 255, 0.3);
            cursor: pointer;
            z-index: 100;
            animation: pulse 3s infinite;
            transition: all 0.5s ease;
        }
        
        .center-circle h3 {
            font-size: 1rem;
            margin-bottom: 5px;
            color: #ffd166;
        }
        
        .center-circle p {
            font-size: 0.9rem;
            padding: 0 15px;
        }
        
        @keyframes pulse {
            0% { box-shadow: 0 0 0 0 rgba(76, 161, 175, 0.7); }
            70% { box-shadow: 0 0 0 20px rgba(76, 161, 175, 0); }
            100% { box-shadow: 0 0 0 0 rgba(76, 161, 175, 0); }
        }
        
        .controls {
            display: flex;
            justify-content: center;
            gap: 15px;
            margin-bottom: 20px;
            flex-wrap: wrap;
        }
        
        .control-btn {
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid #4ca1af;
            color: #a8dadc;
            padding: 10px 20px;
            border-radius: 30px;
            cursor: pointer;
            font-size: 1rem;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .control-btn:hover {
            background: rgba(76, 161, 175, 0.3);
            transform: translateY(-2px);
        }
        
        .control-btn i {
            font-size: 1.2rem;
        }
        
        .statistics {
            display: flex;
            justify-content: center;
            gap: 20px;
            margin-top: 20px;
            flex-wrap: wrap;
        }
        
        .stat-box {
            background: rgba(255, 255, 255, 0.05);
            padding: 15px;
            border-radius: 10px;
            min-width: 150px;
            text-align: center;
            border: 1px solid rgba(76, 161, 175, 0.3);
        }
        
        .stat-value {
            font-size: 2rem;
            font-weight: bold;
            color: #4ca1af;
            margin-bottom: 5px;
        }
        
        .stat-label {
            font-size: 0.9rem;
            color: #a8dadc;
        }
        
        .subsection-item {
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .subsection-item:hover {
            opacity: 1 !important;
            filter: brightness(1.2);
        }
        
        .rotation-controls {
            display: flex;
            gap: 10px;
        }
        
        .rotation-btn {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: rgba(76, 161, 175, 0.3);
            border: 1px solid #4ca1af;
            color: #a8dadc;
            font-size: 1.5rem;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .rotation-btn:hover {
            background: rgba(76, 161, 175, 0.5);
            transform: scale(1.1);
        }
        
        .modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.7);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 2000;
            opacity: 0;
            visibility: hidden;
            transition: all 0.3s ease;
        }
        .modal.active {
            opacity: 1;
            visibility: visible;
        }
        .modal-content {
            background: linear-gradient(135deg, #1b263b 0%, #0d1b2a 100%);
            width: 90%;
            max-width: 500px;
            border-radius: 15px;
            padding: 30px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.5);
            border: 1px solid rgba(76, 161, 175, 0.5);
            position: relative;
            transform: translateY(-20px);
            transition: all 0.4s ease;
        }
        .modal.active .modal-content {
            transform: translateY(0);
        }
        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 25px;
            padding-bottom: 15px;
            border-bottom: 1px solid rgba(76, 161, 175, 0.3);
        }
        .modal-title {
            color: #ffd166;
            font-size: 1.8rem;
            font-weight: 700;
        }
        .close-btn {
            background: transparent;
            border: none;
            color: #a8dadc;
            font-size: 1.8rem;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        .close-btn:hover {
            color: #ff7e5f;
            transform: rotate(90deg);
        }
        .form-group {
            margin-bottom: 20px;
        }
        .form-group label {
            display: block;
            margin-bottom: 10px;
            color: #a8dadc;
            font-size: 1.1rem;
        }
        .form-group input, .form-group textarea, .form-group select {
            width: 100%;
            padding: 12px 15px;
            border-radius: 8px;
            border: 1px solid #4ca1af;
            background: rgba(255, 255, 255, 0.1);
            color: white;
            font-size: 1rem;
            transition: all 0.3s ease;
        }
        .form-group input:focus, .form-group textarea:focus, .form-group select:focus {
            border-color: #ffd166;
            box-shadow: 0 0 10px rgba(255, 209, 102, 0.3);
            outline: none;
        }
        .form-group textarea {
            height: 120px;
            resize: vertical;
        }
        .form-actions {
            display: flex;
            justify-content: center;
            gap: 15px;
            margin-top: 25px;
        }
        .form-btn {
            flex: 1;
            padding: 12px 20px;
            border-radius: 8px;
            border: none;
            cursor: pointer;
            font-weight: bold;
            font-size: 1.1rem;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
        }
        .form-btn.primary {
            background: linear-gradient(135deg, #4ca1af, #2c3e50);
            color: white;
        }
        .form-btn.primary:hover {
            background: linear-gradient(135deg, #3d8c99, #1b263b);
            transform: translateY(-3px);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
        }
        .form-btn.secondary {
            background: rgba(255, 255, 255, 0.1);
            color: #a8dadc;
            border: 1px solid #4ca1af;
        }  
        .form-btn.secondary:hover {
            background: rgba(76, 161, 175, 0.2);
            transform: translateY(-3px);
        }
        .notification {
            position: fixed;
            top: 20px;
            right: 20px;
            background: rgba(76, 161, 175, 0.9);
            color: white;
            padding: 15px 25px;
            border-radius: 10px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
            z-index: 3000;
            display: none;
            animation: slideIn 0.5s forwards, fadeOut 0.5s forwards 2.5s;
            max-width: 350px;
        }
        @keyframes slideIn {
            from {
                transform: translateX(100%);
                opacity: 0;
            }
            to {
                transform: translateX(0);
                opacity: 1;
            }
        }
        @keyframes fadeOut {
            from {
                opacity: 1;
            }
            to {
                opacity: 0;
            }
        }
        .notification-content {
            display: flex;
            align-items: center;
            gap: 15px;
        }
        .notification-icon {
            font-size: 2rem;
            color: #ffd166;
        }
        .notification-text h3 {
            margin-bottom: 5px;
            font-size: 1.2rem;
        }
        .notification-text p {
            font-size: 1rem;
            opacity: 0.9;
        }
        .section-list {
            max-height: 300px;
            overflow-y: auto;
            margin-bottom: 20px;
            border: 1px solid rgba(76, 161, 175, 0.3);
            border-radius: 8px;
            padding: 10px;
        }
        .section-item {
            padding: 12px;
            margin-bottom: 8px;
            background: rgba(255, 255, 255, 0.05);
            border-radius: 6px;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }   
        .section-item:hover {
            background: rgba(76, 161, 175, 0.2);
            transform: translateX(-5px);
        }
        .section-item.active {
            background: rgba(76, 161, 175, 0.3);
            border-left: 4px solid #ffd166;
        }        
        .section-name {
            font-weight: 600;
            color: #a8dadc;
        }
        .section-id {
            background: rgba(255, 209, 102, 0.2);
            color: #ffd166;
            padding: 3px 8px;
            border-radius: 4px;
            font-size: 0.9rem;
        }
        .section-link {
            font-size: 0.85rem;
            color: #4ca1af;
            margin-top: 5px;
            display: block;
            overflow: hidden;
            text-overflow: ellipsis;
            white-space: nowrap;
            direction: ltr;
            text-align: left;
        }
        .link-icon {
            color: #ff7e5f;
            margin-left: 5px;
        }
        .link-button {
            cursor: pointer;
            transition: all 0.3s ease;
            pointer-events: all;
        }
        .link-icon {
            font-size: 14px;
            fill: #4ca1af;
            transition: all 0.3s ease;
        }
        .link-button:hover .link-icon {
            fill: #ffd166;
            transform: scale(1.2);
        }
        .link-icon-text {
            font-family: 'Font Awesome 5 Free';
            font-weight: 900;
            font-size: 14px;
            fill: #4ca1af;
            transition: all 0.3s ease;
        }   
        .database-info {
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 10px;
            margin-top: 15px;
            font-size: 0.9rem;
            color: #4ca1af;
        }
        .db-icon {
            color: #ffd166;
        }
        .title-row {
            display: flex;
            justify-content: space-between;
            width: 100%;
            max-width: 800px;
            margin: 0 auto 20px;
        }
        .title-box {
            background: rgba(255, 255, 255, 0.1);
            padding: 10px 20px;
            border-radius: 8px;
            font-size: 1.2rem;
            font-weight: 600;
            color: #a8dadc;
        }
        .subsection-label {
            position: absolute;
            text-align: center;
            font-size: 10px;
            font-weight: bold;
            z-index: 80;
            pointer-events: none;
            fill: #ffffff;
            text-shadow: 0 0 2px rgba(0,0,0,0.8);
        }
        .inner-label {
            position: absolute;
            text-align: center;
            font-size: 13px;
            font-weight: bold;
            z-index: 90;
            pointer-events: none;
            line-height: 1.3;
        }
        .license-control {
            display: flex;
            justify-content: center;
            margin-bottom: 15px;
        }
        .license-input {
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid #4ca1af;
            color: white;
            padding: 10px 15px;
            border-radius: 30px;
            width: 200px;
            text-align: center;
            font-size: 1rem;
            transition: all 0.3s ease;
            margin-right: 10px;
        }
        .license-input:focus {
            border-color: #ffd166;
            box-shadow: 0 0 10px rgba(255, 209, 102, 0.3);
            outline: none;
        } 
        .license-btn {
            background: linear-gradient(135deg, #4ca1af, #2c3e50);
            border: none;
            color: white;
            padding: 10px 20px;
            border-radius: 30px;
            cursor: pointer;
            font-weight: bold;
            transition: all 0.3s ease;
        }
        .license-btn:hover {
            background: linear-gradient(135deg, #3d8c99, #1b263b);
            transform: translateY(-2px);
        }       
        .license-status {
            text-align: center;
            margin-bottom: 10px;
            font-size: 0.95rem;
            padding: 8px 16px;
            border-radius: 20px;
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid rgba(76, 161, 175, 0.2);
            display: inline-block;
            backdrop-filter: blur(10px);
            transition: all 0.3s ease;
        }
        .license-active {
            color: #06d6a0;
        }
        .license-inactive {
            color: #ff7e5f;
        } 
        
        .team-section {
            margin-top: 30px;
            padding: 30px;
            background: rgba(255, 255, 255, 0.05);
            border-radius: 15px;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
            border: 1px solid rgba(76, 161, 175, 0.3);
            max-width: 1000px;
            margin-left: auto;
            margin-right: auto;
        }
        
        .team-title {
            text-align: center;
            color: #ffd166;
            font-size: 2rem;
            font-weight: bold;
            margin-bottom: 30px;
            text-shadow: 0 0 15px rgba(255, 209, 102, 0.7);
        }
        
        .team-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 25px;
            margin-top: 20px;
        }
        
        .team-member {
            background: rgba(255, 255, 255, 0.08);
            padding: 25px;
            border-radius: 12px;
            border: 1px solid rgba(76, 161, 175, 0.2);
            transition: all 0.3s ease;
            text-align: center;
        }
        
        .team-member:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 25px rgba(76, 161, 175, 0.3);
            border-color: rgba(76, 161, 175, 0.5);
        }
        
        .member-name {
            color: #4ca1af;
            font-size: 1.3rem;
            font-weight: bold;
            margin-bottom: 8px;
        }
        
        .member-role {
            color: #a8dadc;
            font-size: 1rem;
            margin-bottom: 15px;
            font-style: italic;
        }
        
        .member-description {
            color: #a8dadc;
            font-size: 0.9rem;
            line-height: 1.5;
            margin-bottom: 20px;
        }
        
        .social-links {
            display: flex;
            justify-content: center;
            gap: 15px;
        }
        
        .social-link {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            width: 40px;
            height: 40px;
            background: rgba(76, 161, 175, 0.2);
            border: 1px solid rgba(76, 161, 175, 0.3);
            border-radius: 50%;
            color: #4ca1af;
            text-decoration: none;
            transition: all 0.3s ease;
            font-size: 1.2rem;
        }
        
        .social-link:hover {
            background: rgba(76, 161, 175, 0.4);
            color: #ffd166;
            transform: scale(1.1);
            box-shadow: 0 5px 15px rgba(76, 161, 175, 0.3);
        }
        
        .social-link.linkedin:hover {
            background: rgba(0, 119, 181, 0.3);
            border-color: #0077b5;
        }
        
        .social-link.github:hover {
            background: rgba(51, 51, 51, 0.3);
            border-color: #333;
        }
        
        .social-link.twitter:hover {
            background: rgba(29, 161, 242, 0.3);
            border-color: #1da1f2;
        }
        
        .social-link.email:hover {
            background: rgba(234, 67, 53, 0.3);
            border-color: #ea4335;
        }
        
        .suggestion-form .form-group {
            margin-bottom: 15px;
        }
        
        .suggestion-form label {
            display: block;
            margin-bottom: 8px;
            color: #a8dadc;
            font-weight: 500;
        }
        
        .suggestion-form input, 
        .suggestion-form textarea, 
        .suggestion-form select {
            width: 100%;
            padding: 12px 15px;
            border-radius: 8px;
            border: 1px solid #4ca1af;
            background: rgba(255, 255, 255, 0.1);
            color: white;
            font-size: 1rem;
            transition: all 0.3s ease;
        }
        
        .suggestion-form input:focus, 
        .suggestion-form textarea:focus, 
        .suggestion-form select:focus {
            border-color: #ffd166;
            box-shadow: 0 0 10px rgba(255, 209, 102, 0.3);
            outline: none;
        }
        
        .suggestion-form textarea {
            height: 120px;
            resize: vertical;
        }
        
        .suggestion-form .form-actions {
            display: flex;
            justify-content: center;
            gap: 15px;
            margin-top: 20px;
        }
        
        .suggestion-form .form-btn {
            padding: 12px 25px;
            border-radius: 8px;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .suggestion-form .submit-btn {
            background: linear-gradient(135deg, #4ca1af, #2c3e50);
            color: white;
            border: none;
        }
        
        .suggestion-form .submit-btn:hover {
            background: linear-gradient(135deg, #3d8c99, #1b263b);
            transform: translateY(-3px);
        }
        
        .suggestion-form .cancel-btn {
            background: rgba(255, 255, 255, 0.1);
            color: #a8dadc;
            border: 1px solid #4ca1af;
        }
        
        .suggestion-form .cancel-btn:hover {
            background: rgba(76, 161, 175, 0.2);
            transform: translateY(-3px);
        }
        
        .control-btn.suggest-btn {
            background: rgba(6, 214, 160, 0.2);
            border-color: #06d6a0;
        }
        
        .control-btn.suggest-btn:hover {
            background: rgba(6, 214, 160, 0.3);
        }
        
        .control-btn.suggest-btn i {
            color: #06d6a0;
        }

        .clickable-text {
            cursor: pointer;
            transition: all 0.3s ease;
        }
        .clickable-text:hover {
            fill: #ffd166 !important;
            font-size: 11px !important;
            text-shadow: 0 0 8px rgba(255, 209, 102, 0.7);
        }
        
        p {
        display: block;
        margin-block-start: 0.1em;
        margin-block-end: 1em;
        margin-inline-start: 0px;
        margin-inline-end: 0px;
        unicode-bidi: isolate;
        }
        .highlight {
        color: #4ca1af;
        font-weight: 600;
        text-shadow: 0 0 8px rgba(76, 161, 175, 0.7);
        }

        .footer {
        text-align: center;
        margin-top: 20px;
        padding: 20px;
        background: rgba(255, 255, 255, 0.05);
        border-radius: 15px;
        box-shadow: 0 4px 15px rgba(0, 0, 0, 0.3);
        color: #a8dadc;
        font-size: 1.1rem;
        border: 1px solid rgba(76, 161, 175, 0.3);
        max-width: 800px;
        margin-left: auto;
        margin-right: auto;
        }
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        @media (max-width: 768px) {
            .header h1 {
                font-size: 2rem;
            }
            
            .header h2 {
                font-size: 1.5rem;
            }
            
            .header p {
                font-size: 1rem;
            }
            
            .map-container {
                height: 70vh;
            }
            
            .center-circle {
                width: 120px;
                height: 120px;
            }
            
            .center-circle h3 {
                font-size: 1.2rem;
            }
            
            .center-circle p {
                font-size: 0.5rem;
            }
            
            .title-box {
                font-size: 1rem;
                padding: 8px 15px;
            }
            
            .sector-label {
                font-size: 16px;
            }
            
            .inner-label {
                font-size: 11px;
            }
            
            .subsection-label {
                font-size: 8px;
            }
        }
        
        @media (max-width: 480px) {
            .map-container {
                height: 60vh;
            }
            
            .center-circle {
                width: 70px;
                height: 70px;
            }
            
            .center-circle h3 {
                font-size: 8px;
            }
            
            .inner-label {
                font-size: 10px;
            }
            
            .subsection-label {
                font-size: 6px;
            }
        }
    </style>
</head>
<body>
    <div class="title-row">
        <div class="title-box">Question Support</div>
        <div class="title-box">Strategy Syria</div>
    </div>
    <div class="header">
        <h1>خريطة منظومة الابتكار في سوريا</h1>
        <h2>Startup Syria</h2>
        <p>نظام إدارة متكامل مع تأثيرات انتقالية متقدمة</p>
    </div>
    <div class="license-control">
        <input type="password" class="license-input" id="license-input" placeholder="أدخل مفتاح الترخيص">
        <button class="license-btn" id="license-btn">تفعيل الترخيص</button>
    </div>
    <div class="license-status" id="license-status">
        <span class="license-inactive"><i class="fas fa-times-circle"></i> الترخيص غير مفعل</span>
    </div>
    
    <div class="controls">
        <button class="control-btn" id="reset-view">
            <i class="fas fa-sync-alt"></i> إعادة تعيين العرض
        </button>
        <button class="control-btn" id="add-section">
            <i class="fas fa-plus-circle"></i> إضافة قسم جديد
        </button>
        <button class="control-btn" id="edit-section">
            <i class="fas fa-edit"></i> تعديل الأقسام
        </button>
        <div class="rotation-controls" id="rotation-controls">
            <div class="rotation-btn" id="rotate-left" title="تدوير لليسار">
                <i class="fas fa-undo"></i>
            </div>
            <div class="rotation-btn" id="rotate-right" title="تدوير لليمين">
                <i class="fas fa-redo"></i>
            </div>
        </div>

        <button class="control-btn suggestions-btn" id="view-suggestions" style="display: none;">
            <i class="fas fa-list-alt"></i> الاقتراحات
        </button>
        
     
        <div class="modal" id="suggestions-modal">
            <div class="modal-content">
                <div class="modal-header">
                    <h3 class="modal-title">قائمة الاقتراحات المقدمة</h3>
                    <button class="close-btn" id="close-suggestions-modal">
                        <i class="fas fa-times"></i>
                    </button>
                </div>
                <div class="suggestions-container">
                    <div class="suggestions-list" id="suggestions-list">
                      
                    </div>
                </div>
                <div class="form-actions">
                    <button class="form-btn secondary" id="close-suggestions-btn">
                        <i class="fas fa-times"></i> إغلاق
                    </button>
                </div>
            </div>
        </div>

        <div class="modal" id="suggest-company-modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 class="modal-title">اقتراح شركة جديدة</h3>
                <button class="close-btn" id="close-suggest-modal">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <form class="suggestion-form">
                <div class="form-group">
                    <label for="company-name">اسم الشركة *</label>
                    <input type="text" id="company-name" required placeholder="أدخل اسم الشركة">
                </div>
                
                <div class="form-group">
                    <label for="company-field">مجال الشركة *</label>
                    <select id="company-field" required>
                        <option value="">اختر مجال الشركة</option>
                        <option value="تكنولوجيا">تكنولوجيا</option>
                        <option value="تمويل">تمويل واستثمار</option>
                        <option value="تعليم">تعليم وبحث</option>
                        <option value="بنية تحتية">بنية تحتية</option>
                        <option value="دعم">دعم واستشارات</option>
                        <option value="سياسات">سياسات وتنظيم</option>
                        <option value="أخرى">مجال آخر</option>
                    </select>
                </div>
                
                <div class="form-group">
                    <label for="company-description">وصف عن الشركة *</label>
                    <textarea id="company-description" required placeholder="أدخل وصفاً مختصراً عن الشركة ونشاطها"></textarea>
                </div>
                
                <div class="form-group">
                    <label for="company-location">موقع الشركة *</label>
                    <input type="text" id="company-location" required placeholder="المدينة والمنطقة">
                </div>
                
                <div class="form-group">
                    <label for="company-website">رابط موقع الشركة (اختياري)</label>
                    <input type="url" id="company-website" placeholder="https://example.com">
                </div>
                
                <div class="form-actions">
                    <button type="button" class="form-btn cancel-btn" id="cancel-suggest-btn">
                        إلغاء الطلب
                    </button>
                    <button type="submit" class="form-btn submit-btn">
                        <i class="fas fa-paper-plane"></i> إرسال الاقتراح
                    </button>
                </div>
            </form>
        </div>
    </div>
    </div>
    
    <div class="modal" id="suggest-company-modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 class="modal-title">اقتراح شركة جديدة</h3>
                <button class="close-btn" id="close-suggest-modal">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <form class="suggestion-form">
                <div class="form-group">
                    <label for="company-name">اسم الشركة *</label>
                    <input type="text" id="company-name" required placeholder="أدخل اسم الشركة">
                </div>
                
                <div class="form-group">
                    <label for="company-field">مجال الشركة *</label>
                    <select id="company-field" required>
                        <option value="">اختر مجال الشركة</option>
                        <option value="تكنولوجيا">تكنولوجيا</option>
                        <option value="تمويل">تمويل واستثمار</option>
                        <option value="تعليم">تعليم وبحث</option>
                        <option value="بنية تحتية">بنية تحتية</option>
                        <option value="دعم">دعم واستشارات</option>
                        <option value="سياسات">سياسات وتنظيم</option>
                        <option value="أخرى">مجال آخر</option>
                    </select>
                </div>
                
                <div class="form-group">
                    <label for="company-description">وصف عن الشركة *</label>
                    <textarea id="company-description" required placeholder="أدخل وصفاً مختصراً عن الشركة ونشاطها"></textarea>
                </div>
                
                <div class="form-group">
                    <label for="company-location">موقع الشركة *</label>
                    <input type="text" id="company-location" required placeholder="المدينة والمنطقة">
                </div>
                
                <div class="form-group">
                    <label for="company-website">رابط موقع الشركة (اختياري)</label>
                    <input type="url" id="company-website" placeholder="https://example.com">
                </div>
                
                <div class="form-actions">
                    <button type="button" class="form-btn cancel-btn" id="cancel-suggest-btn">
                        إلغاء الطلب
                    </button>
                    <button type="submit" class="form-btn submit-btn">
                        <i class="fas fa-paper-plane"></i> إرسال الاقتراح
                    </button>
                </div>
            </form>
        </div>
    </div>

    <div class="map-container">
        <div class="transition-overlay" id="transition-overlay">
            <div class="transition-content">
                <div class="transition-spinner"></div>
            
            </div>
        </div>
        <div id="concentric-map"></div>
        <div class="center-circle">
            <h3>سوريا</h3>
            <p>المركز الرئيسي</p>
        </div>
    </div>
    
    <div class="notification" id="notification">
        <div class="notification-content">
            <div class="notification-icon">
                <i class="fas fa-check-circle"></i>
            </div>
            <div class="notification-text">
                <h3 id="notification-title">تمت العملية بنجاح!</h3>
                <p id="notification-message">تم إضافة قسم جديد بنجاح</p>
            </div>
        </div>
    </div>
    
    <div class="team-section">
        <h2 class="team-title">فريق العمل</h2>
        <div class="team-grid">
            <div class="team-member">
                <div class="member-name">أحمد محمد</div>
                <div class="member-role">مطور واجهات أمامية</div>
                <div class="member-description">
                    متخصص في تطوير واجهات المستخدم باستخدام React و D3.js، مع خبرة في تصميم التفاعلات المتقدمة والرسوم البيانية التفاعلية.
                </div>
                <div class="social-links">
                    <a href="https://linkedin.com/in/ahmed-mohamed" target="_blank" class="social-link linkedin">
                        <i class="fab fa-linkedin-in"></i>
                    </a>
                    <a href="https://github.com/ahmed-mohamed" target="_blank" class="social-link github">
                        <i class="fab fa-github"></i>
                    </a>
                    <a href="mailto:ahmed@startupsyria.com" class="social-link email">
                        <i class="fas fa-envelope"></i>
                    </a>
                </div>
            </div>
            
            <div class="team-member">
                <div class="member-name">سارة أحمد</div>
                <div class="member-role">مصممة UX/UI</div>
                <div class="member-description">
                    خبيرة في تصميم تجربة المستخدم وواجهات التطبيقات، متخصصة في إنشاء تصاميم بديهية وجذابة تركز على احتياجات المستخدم.
                </div>
                <div class="social-links">
                    <a href="https://linkedin.com/in/sara-ahmed" target="_blank" class="social-link linkedin">
                        <i class="fab fa-linkedin-in"></i>
                    </a>
                    <a href="https://github.com/sara-ahmed" target="_blank" class="social-link github">
                        <i class="fab fa-github"></i>
                    </a>
                    <a href="https://twitter.com/sara_ahmed" target="_blank" class="social-link twitter">
                        <i class="fab fa-twitter"></i>
                    </a>
                </div>
            </div>
            
            <div class="team-member">
                <div class="member-name">محمد علي</div>
                <div class="member-role">مطور خلفي</div>
                <div class="member-description">
                    متخصص في تطوير الخوادم وقواعد البيانات، خبير في Firebase و Node.js مع التركيز على الأمان وقابلية التوسع.
                </div>
                <div class="social-links">
                    <a href="https://linkedin.com/in/mohamed-ali" target="_blank" class="social-link linkedin">
                        <i class="fab fa-linkedin-in"></i>
                    </a>
                    <a href="https://github.com/mohamed-ali" target="_blank" class="social-link github">
                        <i class="fab fa-github"></i>
                    </a>
                    <a href="mailto:mohamed@startupsyria.com" class="social-link email">
                        <i class="fas fa-envelope"></i>
                    </a>
                </div>
            </div>
            
            <div class="team-member">
                <div class="member-name">فاطمة حسن</div>
                <div class="member-role">محللة بيانات</div>
                <div class="member-description">
                    خبيرة في تحليل البيانات وإنشاء التقارير، متخصصة في استخراج الرؤى من البيانات المعقدة وتحويلها إلى معلومات قابلة للتنفيذ.
                </div>
                <div class="social-links">
                    <a href="https://linkedin.com/in/fatima-hassan" target="_blank" class="social-link linkedin">
                        <i class="fab fa-linkedin-in"></i>
                    </a>
                    <a href="https://twitter.com/fatima_hassan" target="_blank" class="social-link twitter">
                        <i class="fab fa-twitter"></i>
                    </a>
                    <a href="mailto:fatima@startupsyria.com" class="social-link email">
                        <i class="fas fa-envelope"></i>
                    </a>
                </div>
            </div>
        </div>
    </div>

    <div class="statistics">
        <div class="stat-box">
            <div class="stat-value">42</div>
            <div class="stat-label">منظمة داعمة</div>
        </div>
        <div class="stat-box">
            <div class="stat-value">18</div>
            <div class="stat-label">حاضنة أعمال</div>
        </div>
        <div class="stat-box">
            <div class="stat-value">127</div>
            <div class="stat-label">مشروع ناشئ</div>
        </div>
        <div class="stat-box">
            <div class="stat-value">$5.2M</div>
            <div class="stat-label">استثمارات</div>
        </div>
    </div>
    <div class="footer">
        <div class="database-info">
            <i class="fas fa-database db-icon"></i>
            <span>جميع التغييرات محفوظة في قاعدة البيانات المحلية - آخر حفظ: <span id="last-save-time">لم يتم الحفظ بعد</span></span>
        </div>
        <p>Source: <span class="highlight">Data Collected by Startup Syria 2025</span></p>
    </div>
    
    <div class="modal" id="add-section-modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 class="modal-title">إضافة قسم جديد</h3>
                <button class="close-btn" id="close-add-modal">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="form-group">
                <label for="new-section-name">اسم القسم الجديد</label>
                <input type="text" id="new-section-name" placeholder="أدخل اسم القسم الجديد هنا">
            </div>
            <div class="form-group">
                <label for="section-link">رابط القسم (اختياري)</label>
                <input type="url" id="section-link" placeholder="https://example.com">
            </div>
            <div class="form-actions">
                <button class="form-btn secondary" id="cancel-add-btn">
                    <i class="fas fa-times"></i> إلغاء
                </button>
                <button class="form-btn primary" id="confirm-add-btn">
                    <i class="fas fa-plus"></i> إضافة القسم
                </button>
            </div>
        </div>
    </div>
    
    <div class="modal" id="edit-section-modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 class="modal-title">تعديل الأقسام</h3>
                <button class="close-btn" id="close-edit-modal">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="form-group">
                <label for="section-select">اختر القسم للتعديل</label>
                <div class="section-list" id="section-list"></div>
            </div>
            <div class="form-group">
                <label for="edit-section-content">اسم القسم الجديد</label>
                <input type="text" id="edit-section-content" placeholder="أدخل الاسم الجديد للقسم">
            </div>
            <div class="form-group">
                <label for="edit-section-link">رابط القسم</label>
                <input type="url" id="edit-section-link" placeholder="https://example.com">
            </div>
            <div class="form-actions">
                <button class="form-btn secondary" id="cancel-edit-btn">
                    <i class="fas fa-times"></i> إلغاء
                </button>
                <button class="form-btn primary" id="confirm-edit-btn">
                    <i class="fas fa-save"></i> حفظ التغييرات
                </button>
            </div>
        </div>
    </div>
    <script>
        document.addEventListener('DOMContentLoaded', async function() {
            // تكوين Firebase
            const firebaseConfig = {
                apiKey: "AIzaSyAFwUMYczS1GbGzfa56blHRpS6hjY30DL8",
                authDomain: "startup-syria-map.firebaseapp.com",
                projectId: "startup-syria-map",
                storageBucket: "startup-syria-map.appspot.com",
                messagingSenderId: "190890951419",
                appId: "1:190890951419:web:dd712fbbca9c20ba31a65e",
                databaseURL: "https://startup-syria-map-default-rtdb.firebaseio.com"
            };
            
            // تهيئة Firebase
            firebase.initializeApp(firebaseConfig);
            const database = firebase.database();
            
            const width = 800;
            const height = 800;
            const centerX = width / 2;
            const centerY = height / 2;
            const svg = d3.select("#concentric-map")
                .append("svg")
                .attr("width", "100%")
                .attr("height", "100%")
                .attr("viewBox", `0 0 ${width} ${height}`)
                .attr("preserveAspectRatio", "xMidYMid meet");
            
            const rings = [
                { id: 1, innerRadius: 50, outerRadius: 150, name: "الحلقة الداخلية", color: "rgba(76, 161, 175, 0.3)" },
                { id: 2, innerRadius: 150, outerRadius: 350, name: "الحلقة الخارجية", color: "rgba(255, 126, 95, 0.3)" }
            ];
            
            const sectors = [
                { 
                    id: 1, 
                    name: "Ideation Support", 
                    color: "#008080", 
                    startAngle: 0, 
                    endAngle: 2*Math.PI/5, 
                    subsections: [
                        "Incubators",
                        "Venture Studios",
                        "Competition Events",
                        "Mentorship Programs",
                        "Academic Institutions",
                        "Academic Institutions",
                        "Talent Development"
                    ]
                },
                { 
                    id: 2, 
                    name: "Operation, Growth, and Markets", 
                    color: "#ff6600", 
                    startAngle: 2*Math.PI/5, 
                    endAngle: 4*Math.PI/5, 
                    subsections: [
                        "Co-working Spaces",
                        "Research and Development Labs",
                        "Startup Hiring",
                        "Startup Accounting",
                        "Startup Marketing",
                        "Women's Support"
                    ]
                },
                { 
                    id: 3, 
                    name: "Regulations and Government Support", 
                    color: "#ffdd33", 
                    startAngle: 4*Math.PI/5, 
                    endAngle: 6*Math.PI/5, 
                    subsections: [
                        "Governmental Support",
                        "Legal Support",
                        "Banks"
                    ]
                },
                { 
                    id: 4, 
                    name: "Networking and Cultures", 
                    color: "#cc3366", 
                    startAngle: 6*Math.PI/5, 
                    endAngle: 8*Math.PI/5, 
                    subsections: [
                        "Media",
                        "Events",
                        "NGOs",
                        "Startup Podcasts",
                      //  "Innovation Hub" 
                    ]
                },
                { 
                    id: 5, 
                    name: "Funding", 
                    color: "#0066cc", 
                    startAngle: 8*Math.PI/5, 
                    endAngle: 2*Math.PI, 
                    subsections: [
                        "Financial Development Institutions",
                        "TVenture Capitals",
                        "Private Equity",
                        "Angel Investors",
                        "Crowdfunding",
                        "Family Offices",
                        "Fund of Funds"
                    ]
                }
            ];
            
            let activeSection = null;
            let rotationAngle = 0;
            let sectionCount = 8;
            let sectionDatabase = {};
            let nestingLevel = 0;
            const MAX_NESTING_LEVEL = 1;
            let licenseActive = false;
            
            const licenseInput = document.getElementById('license-input');
            const licenseBtn = document.getElementById('license-btn');
            const licenseStatus = document.getElementById('license-status');
            const lastSaveTimeElement = document.getElementById('last-save-time');
            
   
            function updateLastSaveTime() {
                const now = new Date();
                lastSaveTimeElement.textContent = now.toLocaleTimeString('ar-SA');
            }
            
          
            function loadLicenseStatus() {
                const savedLicense = localStorage.getItem('innovationMapLicense');
                if (savedLicense) {
                    try {
                        const licenseData = JSON.parse(savedLicense);
                        licenseActive = licenseData.active || false;
                    } catch (error) {
                        console.error('Error loading license status:', error);
                        licenseActive = false;
                    }
                }
            }
            
            // حفظ حالة الترخيص في localStorage
            function saveLicenseStatus() {
                try {
                    const licenseData = {
                        active: licenseActive,
                        timestamp: Date.now()
                    };
                    localStorage.setItem('innovationMapLicense', JSON.stringify(licenseData));
                } catch (error) {
                    console.error('Error saving license status:', error);
                }
            }
            
            function updateLicenseUI() {
                if (licenseActive) {
                    licenseStatus.innerHTML = '<span class="license-active"><i class="fas fa-check-circle"></i> الترخيص مفعل</span>';
                    document.getElementById('add-section').style.display = 'flex';
                    document.getElementById('edit-section').style.display = 'flex';
                } else {
                    licenseStatus.innerHTML = '<span class="license-inactive"><i class="fas fa-times-circle"></i> الترخيص غير مفعل</span>';
                    document.getElementById('add-section').style.display = 'none';
                    document.getElementById('edit-section').style.display = 'none';
                }
            }
            
            async function verifyLicenseKey(key) {
                return new Promise((resolve) => {
                    setTimeout(() => {
                        const hashedKey = CryptoJS.SHA256(key).toString();
                        const validKeys = [
                            "42281dc0e8dbaab0cded0057f015964d8738477fdcd4c25480b4a95bdb6c0f4b",
                            "a665a45920422f9d417e4867efdc4fb8a04a1f3fff1fa07e998e86f7f7a27ae3", 
                            "ef2d127de37b942baad06145e54b0c619a1f22327b2ebbcfbec78f5564afe39d"  
                        ];
                        resolve(validKeys.includes(hashedKey));
                    }, 500);
                });
            }
            
            const suggestionsBtn = document.getElementById('view-suggestions');

            function updateLicenseUI() {
                if (licenseActive) {
                    licenseStatus.innerHTML = '<span class="license-active"><i class="fas fa-check-circle"></i> الترخيص مفعل</span>';
                    document.getElementById('add-section').style.display = 'flex';
                    document.getElementById('edit-section').style.display = 'flex';
                    document.getElementById('view-suggestions').style.display = 'flex'; 
                } else {
                    licenseStatus.innerHTML = '<span class="license-inactive"><i class="fas fa-times-circle"></i> الترخيص غير مفعل</span>';
                    document.getElementById('add-section').style.display = 'none';
                    document.getElementById('edit-section').style.display = 'none';
                    document.getElementById('view-suggestions').style.display = 'none'; 
                }
            }
    
            document.getElementById('view-suggestions').addEventListener('click', function() {
                document.getElementById('suggestions-modal').classList.add('active');
                loadSuggestions();
            });
            
            document.getElementById('close-suggestions-modal').addEventListener('click', function() {
                document.getElementById('suggestions-modal').classList.remove('active');
            });
            
            document.getElementById('close-suggestions-btn').addEventListener('click', function() {
                document.getElementById('suggestions-modal').classList.remove('active');
            });
            
       
            function loadSuggestions() {
                const suggestionsList = document.getElementById('suggestions-list');
                suggestionsList.innerHTML = '';
                
                const suggestions = JSON.parse(localStorage.getItem('companySuggestions') || '[]');
                
                if (suggestions.length === 0) {
                    suggestionsList.innerHTML = `
                        <div class="no-suggestions">
                            <i class="fas fa-inbox" style="font-size: 3rem; margin-bottom: 15px;"></i>
                            <p>لا توجد اقتراحات متاحة حالياً</p>
                            <p>كن أول من يقترح شركة جديدة!</p>
                        </div>
                    `;
                    return;
                }
                
                suggestions.forEach((suggestion, index) => {
                    const suggestionItem = document.createElement('div');
                    suggestionItem.className = 'suggestion-item';
               
                    const date = new Date(suggestion.timestamp);
                    const formattedDate = date.toLocaleDateString('ar-SA', {
                        year: 'numeric',
                        month: 'long',
                        day: 'numeric',
                        hour: '2-digit',
                        minute: '2-digit'
                    });
                    
                    suggestionItem.innerHTML = `
                        <div class="suggestion-header">
                            <div class="suggestion-title">${suggestion.name}</div>
                            <div class="suggestion-field">${suggestion.field}</div>
                        </div>
                        
                        <div class="suggestion-content">
                            <div class="suggestion-detail">
                                <span class="suggestion-label">الوصف:</span>
                                <span class="suggestion-value">${suggestion.description}</span>
                            </div>
                            
                            <div class="suggestion-detail">
                                <span class="suggestion-label">الموقع:</span>
                                <span class="suggestion-value">${suggestion.location}</span>
                            </div>
                            
                            ${suggestion.website ? `
                            <div class="suggestion-detail">
                                <span class="suggestion-label">الموقع الإلكتروني:</span>
                                <a href="${suggestion.website}" target="_blank" class="suggestion-value suggestion-website">
                                    ${suggestion.website}
                                </a>
                            </div>
                            ` : ''}
                            
                            <div class="suggestion-detail">
                                <span class="suggestion-label">تاريخ الاقتراح:</span>
                                <span classs="suggestion-value">${formattedDate}</span>
                            </div>
                            
                            <div class="suggestion-status status-pending">
                                <i class="fas fa-clock"></i> قيد المراجعة
                            </div>
                        </div>
                    `;
                    
                    suggestionsList.appendChild(suggestionItem);
                });
            }
            
            const suggestBtn = document.createElement('button');
            suggestBtn.className = 'control-btn suggest-btn';
            suggestBtn.id = 'suggest-company';
            suggestBtn.innerHTML = '<i class="fas fa-lightbulb"></i> اقترح شركة';
            document.querySelector('.controls').appendChild(suggestBtn);

            document.getElementById('suggest-company').addEventListener('click', function() {
                document.getElementById('suggest-company-modal').classList.add('active');
                document.getElementById('company-name').value = '';
                document.getElementById('company-field').value = '';
                document.getElementById('company-description').value = '';
                document.getElementById('company-location').value = '';
                document.getElementById('company-website').value = '';
                document.getElementById('company-name').focus();
            });
            
            document.getElementById('close-suggest-modal').addEventListener('click', function() {
                document.getElementById('suggest-company-modal').classList.remove('active');
            });
            
            document.getElementById('cancel-suggest-btn').addEventListener('click', function() {
                document.getElementById('suggest-company-modal').classList.remove('active');
            });
          
            document.querySelector('.suggestion-form').addEventListener('submit', function(e) {
                e.preventDefault();
                
   
                const companyData = {
                    name: document.getElementById('company-name').value,
                    field: document.getElementById('company-field').value,
                    description: document.getElementById('company-description').value,
                    location: document.getElementById('company-location').value,
                    website: document.getElementById('company-website').value || '',
                    timestamp: new Date().toISOString(),
                    status: 'pending'
                };

                if (!companyData.name || !companyData.field || !companyData.description || !companyData.location) {
                    showNotification('خطأ في الإدخال', 'الرجاء تعبئة جميع الحقول المطلوبة');
                    return;
                }

                const submitBtn = document.querySelector('.suggestion-form .submit-btn');
                const originalBtnText = submitBtn.innerHTML;
                submitBtn.innerHTML = '<i class="fas fa-spinner fa-spin"></i> جاري الإرسال...';
                submitBtn.disabled = true;
                

                setTimeout(() => {
             
                    let suggestions = JSON.parse(localStorage.getItem('companySuggestions') || '[]');
                    suggestions.push(companyData);
                    localStorage.setItem('companySuggestions', JSON.stringify(suggestions));
            
                    submitBtn.innerHTML = originalBtnText;
                    submitBtn.disabled = false;
                    
                    showNotification('شكراً لك!', 'تم استلام اقتراحك بنجاح وسيتم دراسته من قبل فريقنا');
                    
                    document.getElementById('suggest-company-modal').classList.remove('active');
                }, 1500);
            });

            licenseBtn.addEventListener('click', async function() {
                const enteredKey = licenseInput.value.trim();
                
                if (!enteredKey) {
                    showNotification('خطأ في الإدخال', 'يرجى إدخال مفتاح الترخيص');
                    return;
                }
                
    
                licenseStatus.innerHTML = '<span><i class="fas fa-spinner fa-spin"></i> جاري التحقق من الترخيص...</span>';
                
                try {
                    const isValid = await verifyLicenseKey(enteredKey);
                    
                    if (isValid) {
                        licenseActive = true;
                        saveLicenseStatus(); 
                        licenseInput.value = ''; 
                        showNotification('تم التفعيل بنجاح!', 'تم تفعيل الترخيص بنجاح');
                    } else {
                        licenseActive = false;
                        showNotification('خطأ في الترخيص', 'مفتاح الترخيص غير صحيح');
                    }
                } catch (error) {
                    console.error("License verification error:", error);
                    licenseActive = false;
                    showNotification('خطأ في النظام', 'فشل التحقق من الترخيص، يرجى المحاولة لاحقاً');
                }
                
                updateLicenseUI();
            });    
            
     
            async function loadData() {
                try {

                    const localData = localStorage.getItem('innovationMapData');
                    if (localData) {
                        try {
                            const parsedData = JSON.parse(localData);
                            sectionDatabase = parsedData.data || parsedData; 
                            ensureAllSectionsExist();
                            console.log('تم تحميل البيانات من التخزين المحلي');
                            

                            if (parsedData.timestamp) {
                                const saveDate = new Date(parsedData.timestamp);
                                lastSaveTimeElement.textContent = saveDate.toLocaleTimeString('ar-SA');
                            }
                        } catch (error) {
                            console.error('خطأ في تحليل البيانات المحلية:', error);
                            initializeDatabase();
                        }
                    } else {

                        try {
                            const snapshot = await database.ref('innovationMapData').once('value');
                            if (snapshot.exists()) {
                                sectionDatabase = snapshot.val();
                                ensureAllSectionsExist();
                                saveDataLocally();
                                console.log('تم تحميل البيانات من Firebase');
                            } else {
                                initializeDatabase();
                                console.log('تم إنشاء بيانات جديدة');
                            }
                        } catch (firebaseError) {
                            console.error('خطأ في تحميل البيانات من Firebase:', firebaseError);
                            initializeDatabase();
                        }
                    }
                    
                    return true;
                } catch (error) {
                    console.error("خطأ عام في تحميل البيانات:", error);
                    initializeDatabase();
                    return false;
                }
            }
            

            function ensureAllSectionsExist() {
                let hasChanges = false;
                sectors.forEach(sector => {
                    sector.subsections.forEach(subsection => {
                        if (!sectionDatabase[subsection]) {
                 
                            sectionDatabase[subsection] = {
                                sectionNames: Array.from({length: sectionCount}, (_, i) => `القسم ${i+1}`),
                                sectionLinks: Array(sectionCount).fill(''),
                                sectorColor: sector.color
                            };
                            hasChanges = true;
                        }
                    });
                });
                
                if (hasChanges) {
                    saveData();
                }
            }
            

            function saveDataLocally() {
                try {
                    const dataToSave = {
                        data: sectionDatabase,
                        timestamp: Date.now(),
                        version: '1.0'
                    };
                    localStorage.setItem('innovationMapData', JSON.stringify(dataToSave));
                    updateLastSaveTime();
                    console.log('تم حفظ البيانات محلياً');
                    return true;
                } catch (error) {
                    console.error('خطأ في الحفظ المحلي:', error);
                    return false;
                }
            }
            async function saveData() {
                try {

                    const localSaved = saveDataLocally();
                    

                    try {
                        await database.ref('innovationMapData').set(sectionDatabase);
                        console.log('تم حفظ البيانات في Firebase');
                        return true;
                    } catch (firebaseError) {
                        console.error("خطأ في حفظ البيانات في Firebase:", firebaseError);
             
                        if (localSaved) {
                            showNotification('تم الحفظ محلياً', 'تم حفظ البيانات في التخزين المحلي فقط');
                            return true;
                        }
                        return false;
                    }
                } catch (error) {
                    console.error("خطأ عام في حفظ البيانات:", error);
                    return false;
                }
            }
            
          
            function setupRealtimeUpdates() {
                try {
                    database.ref('innovationMapData').on('value', (snapshot) => {
                        if (snapshot.exists()) {
                            const firebaseData = snapshot.val();
                  
                            if (JSON.stringify(firebaseData) !== JSON.stringify(sectionDatabase)) {
                                sectionDatabase = firebaseData;
                                ensureAllSectionsExist();
                                
                                if (activeSection) {
                                    const sectorColor = sectionDatabase[activeSection]?.sectorColor || "#4ca1af";
                                    createNewCircleMap(activeSection, sectorColor);
                                } else {
                                    drawMap();
                                }
                                
                         
                                saveDataLocally();
                                console.log('تم تحديث البيانات من Firebase');
                            }
                        }
                    });
                } catch (error) {
                    console.error('خطأ في إعداد التحديثات المباشرة:', error);
                }
            }
            
            function initializeDatabase() {
                sectors.forEach(sector => {
                    sector.subsections.forEach(subsection => {
                        sectionDatabase[subsection] = {
                            sectionNames: Array.from({length: sectionCount}, (_, i) => `القسم ${i+1}`),
                            sectionLinks: Array(sectionCount).fill(''),
                            sectorColor: sector.color
                        };
                    });
                });
           
                saveData();
            }
            
            function drawMap() {
                svg.selectAll("*").remove();
                rings.forEach(ring => {
                    sectors.forEach(sector => {
                        const startAngle = sector.startAngle + rotationAngle;
                        const endAngle = sector.endAngle + rotationAngle;
                        if (ring.id === 2) {
                            const sectorAngleRange = endAngle - startAngle;
                            const subsectionAngle = sectorAngleRange / sector.subsections.length;
                            for (let i = 0; i < sector.subsections.length; i++) {
                                const subsectionName = sector.subsections[i];
                                const subsectionStartAngle = startAngle + i * subsectionAngle;
                                const subsectionEndAngle = subsectionStartAngle + subsectionAngle;
                                const arcGenerator = d3.arc()
                                    .innerRadius(ring.innerRadius)
                                    .outerRadius(ring.outerRadius)
                                    .startAngle(subsectionStartAngle)
                                    .endAngle(subsectionEndAngle);
                                const path = svg.append("path")
                                    .attr("d", arcGenerator())
                                    .attr("transform", `translate(${centerX}, ${centerY})`)
                                    .attr("fill", sector.color)
                                    .attr("stroke", "white")
                                    .attr("stroke-width", 1)
                                    .attr("opacity", 0.8)
                                    .attr("class", "subsection")
                                    .attr("data-sector", sector.id)
                                    .attr("data-subsection", i)
                                    .on("mouseover", function() {
                                        d3.select(this).attr("opacity", 1);
                                    })
                                    .on("mouseout", function() {
                                        d3.select(this).attr("opacity", 0.8);
                                    });
                                if (nestingLevel === 0) {
                                    path.on("click", function() {
                                        nestingLevel++;  
                                        const sectorColor = sector.color;
                                        createNewCircleMap(subsectionName, sectorColor);
                                    });
                                }
                                const middleAngle = subsectionStartAngle + subsectionAngle / 2;
                                const textRadius = (ring.innerRadius + ring.outerRadius) / 2;
                                const correctedAngle = middleAngle + 4.728;
                                const x = centerX + textRadius * Math.cos(correctedAngle);
                                const y = centerY + textRadius * Math.sin(correctedAngle);
                                let rotation = (middleAngle * 180 / Math.PI) + 89;
                                if (rotation > 90 && rotation < 270) {
                                    rotation += 180;
                                }
                                const g = svg.append("g")
                                    .attr("transform", `translate(${x}, ${y}) rotate(${rotation})`)
                                    .attr("class", "subsection-label");
                                const labelText = subsectionName;
                                const maxCharsPerLine = 12;
                                let lines = [];
                                if (labelText.length > maxCharsPerLine) {
                                    const words = labelText.split(' ');
                                    let line = "";
                                    words.forEach(word => {
                                        if ((line + word).length <= maxCharsPerLine) {
                                            line += (line ? " " : "") + word;
                                        } else {
                                            lines.push(line);
                                            line = word;
                                        }
                                    });
                                    if (line) lines.push(line);
                                } else {
                                    lines = [labelText];
                                }
                                const lineHeight = 12;
                                const startY = -((lines.length - 1) * lineHeight) / 2;
                                lines.forEach((line, index) => {
                                    g.append("text")
                                        .attr("x", 0)
                                        .attr("y", startY + index * lineHeight)
                                        .attr("text-anchor", "middle")
                                        .attr("dy", "0.35em")
                                        .attr("fill", "#ffffff")
                                        .attr("font-size", "10px")
                                        .attr("font-weight", "bold")
                                        .text(line);
                                });
                            }
                        } else {
                            const arcGenerator = d3.arc()
                                .innerRadius(ring.innerRadius)
                                .outerRadius(ring.outerRadius)
                                .startAngle(startAngle)
                                .endAngle(endAngle);
                            const path = svg.append("path")
                                .attr("d", arcGenerator())
                                .attr("transform", `translate(${centerX}, ${centerY})`)
                                .attr("fill", sector.color)
                                .attr("stroke", "white")
                                .attr("stroke-width", 1)
                                .attr("opacity", 0.8)
                                .attr("class", "sector")
                                .attr("data-sector", sector.id)
                                .on("mouseover", function() {
                                    d3.select(this).attr("opacity", 1);
                                })
                                .on("mouseout", function() {
                                    d3.select(this).attr("opacity", 0.8);
                                });
                        }
                    });
                });
                const innerLabels = [
                    { 
                        lines: ["Regulations and", "Government Support"], 
                        color: "#ffff",
                        angle: Math.PI * 0.5 + rotationAngle
                    },
                    { 
                        lines: ["Ideation Support"],
                        color: "#ffff",
                        angle: Math.PI * 1.7 + rotationAngle
                    },
                    { 
                        lines: ["Networking and", "Cultures"],
                        color: "#ffff",
                        angle: Math.PI * 0.9 + rotationAngle
                    },
                    { 
                        lines: ["Operation, Growth", "and Markets"],
                        color: "#ffff",
                        angle: Math.PI * 0.1 + rotationAngle
                    },
                    { 
                        lines: ["Funding"],
                        color: "#ffff",
                        angle: Math.PI * 3.3 + rotationAngle
                    }
                ];
                const innerRadius = 100;
                innerLabels.forEach((label) => {
                    const x = centerX + innerRadius * Math.cos(label.angle);
                    const y = centerY + innerRadius * Math.sin(label.angle);
                    let rotation = (label.angle * 180 / Math.PI) + 90;
                    if (rotation > 90 && rotation < 270) {
                        rotation += 180;
                    }
                    const g = svg.append("g")
            .attr("transform", `translate(${x}, ${y}) rotate(${rotation})`)
                        .attr("class", "inner-label");               
     const lineHeight = 15;
                    const startY = -((label.lines.length - 1) * lineHeight) / 2;
                    label.lines.forEach((line, i) => {
                        if (line === "Funding") {
                            g.append("text")
                                .attr("x", 0)
                                .attr("y", startY + i * lineHeight - 4)
                                .attr("text-anchor", "middle")
                                .attr("dy", "0.35em")
                                .attr("fill", label.color)
                                .attr("font-size", "15px")
                                .attr("font-weight", "bold")
                                .text(line);
                        } else {
                            g.append("text")
                                .attr("x", 0)
                                .attr("y", startY + i * lineHeight)
                                .attr("text-anchor", "middle")
                                .attr("dy", "0.35em")
                                .attr("fill", label.color)
                                .attr("font-size", "13px")
                                .attr("font-weight", "bold")
                                .text(line);
                        }
                    });
                });
            }
            
            function createNewCircleMap(subsectionName, sectorColor) {
               const transitionOverlay = document.getElementById('transition-overlay');
               // transitionOverlay.classList.add('active');
                                const concentricMap = document.getElementById('concentric-map');
                concentricMap.classList.add('zoom-out');
                setTimeout(() => {
           
                    svg.selectAll("*").remove();
                    
        document.querySelector('.center-circle').innerHTML = `
                <h3>${subsectionName}</h3>
                    `;
                    
            
                    concentricMap.classList.remove('zoom-out');
                    concentricMap.classList.add('zoom-in');
                    
               
                    const currentData = sectionDatabase[subsectionName];    
                    if (!currentData) {
                        const parentSector = sectors.find(sector => 
                            sector.subsections.includes(subsectionName)
                        );
                        sectionDatabase[subsectionName] = {
                            sectionNames: Array.from({length: sectionCount}, (_, i) => `القسم ${i+1}`),
                            sectionLinks: Array(sectionCount).fill(''),
                            sectorColor: parentSector ? parentSector.color : "#4ca1af"
                        }; 
                        saveData();
                    }
                    
                    const sectionNames = sectionDatabase[subsectionName].sectionNames;
                    const sectionLinks = sectionDatabase[subsectionName].sectionLinks;
                   
                    const baseSectionsPerRing = 20;
                    
                  
                    let remainingSections = sectionNames.length;
                    let dynamicRingCounts = [];
                    let currentRing = 0;
                    
                    while (remainingSections > 0) {
                        const sectionsThisRing = baseSectionsPerRing + currentRing * 60;
                        dynamicRingCounts.push(sectionsThisRing);
                        remainingSections -= sectionsThisRing;
                        currentRing++;
                    }
                    const ringThickness = 350;
  
                    let sectionIndexGlobal = 0;
                    
                    for (let ringIndex = 0; ringIndex < dynamicRingCounts.length; ringIndex++) {
                        const sectionsInThisRing = dynamicRingCounts[ringIndex];
                    
                        const startIndex = sectionIndexGlobal;
                        const endIndex = Math.min(startIndex + sectionsInThisRing, sectionNames.length);
                        const actualSections = endIndex - startIndex;
                    
                        if (actualSections === 0) break;
                        sectionIndexGlobal += actualSections;
                    
                        const ringInnerRadius = 75 + ringIndex * 140;
                        const ringOuterRadius = ringInnerRadius + 140;
                    
                        if (ringIndex > 0) {
                       
                            svg.append("circle")
                                .attr("cx", centerX)
                                .attr("cy", centerY)
                                .attr("r", ringOuterRadius + 5)
                                .attr("fill", "none")
                              //  .attr("stroke", "#ffd166")
                                .attr("stroke-width", 2)
                               // .attr("stroke-dasharray", "5,5")
                                .attr("class", "ring-highlight")
                                .attr("opacity", 0.7);
                            
                        
                        }
                    
                        const sectorAngle = (2 * Math.PI) / actualSections;
                    
                        for (let i = 0; i < actualSections; i++) {
                            const sectionIndex = startIndex + i;
                            const startAngle = i * sectorAngle;
                            const endAngle = (i + 1) * sectorAngle;
                            
                            const arcGenerator = d3.arc()
                                .innerRadius(ringInnerRadius)
                                .outerRadius(ringOuterRadius)
                                .startAngle(startAngle)
                                .endAngle(endAngle);
                            
                            const path = svg.append("path")
                                .attr("d", arcGenerator())
                                .attr("transform", `translate(${centerX}, ${centerY})`)
                                .attr("fill", sectorColor)
                                .attr("stroke", "white")
                                .attr("stroke-width", 1)
                                .attr("opacity", 0.8)
                                .attr("class", "subsection-item")
                                .attr("data-section", sectionIndex)
                                .on("mouseover", function() {
                                    d3.select(this).attr("opacity", 1);
                                })
                                .on("mouseout", function() {
                                    d3.select(this).attr("opacity", 0.8);
                                });
                            
                            if (sectionLinks[sectionIndex]) {
                                path.on("click", function() {
                                    window.open(sectionLinks[sectionIndex], '_blank');
                                });
                            }
                    
                            const middleAngle = startAngle + sectorAngle / 2;
                            const textRadius = ringInnerRadius + (ringOuterRadius - ringInnerRadius) / 2;
                            const correctedAngle = middleAngle + 4.728;
                            const x = centerX + textRadius * Math.cos(correctedAngle);
                            const y = centerY + textRadius * Math.sin(correctedAngle);
                            
                            let rotation = (middleAngle * 180 / Math.PI) + 90;
                            if (rotation > 90 && rotation < 270) {
                                rotation += 180;
                            }
                            
                            const g = svg.append("g")
                                .attr("transform", `translate(${x}, ${y}) rotate(${rotation})`)
                                .attr("class", "subsection-label");
                            
                            const text = g.append("text")
                                .attr("x", 0)
                                .attr("y", 0)
                                .attr("text-anchor", "middle")
                                .attr("dy", "0.35em")
                                .attr("font-size", ringIndex > 0 ? "8px" : "9px")
                                .attr("font-weight", "bold")
                                .text(sectionNames[sectionIndex]);
                            
                            if (sectionLinks[sectionIndex]) {
                                text.attr("fill", "#ffd166")
                                    .attr("class", "clickable-text")
                                    .on("click", function() {
                                        window.open(sectionLinks[sectionIndex], '_blank');
                                    });
                            } else {
                                text.attr("fill", "#ffffff");
                            }
                        }
                    }
                    
                    svg.append("circle")
                        .attr("cx", centerX)
                        .attr("cy", centerY)
                        .attr("r", 50)
                        .attr("fill", "none")
                        .attr("stroke", "rgba(255, 255, 255, 0.2)")
                        .attr("stroke-dasharray", "5,5")
                        .attr("stroke-width", 1);
                    
                    activeSection = subsectionName;
                 
                    setTimeout(() => {
                        concentricMap.classList.remove('zoom-in');
                        transitionOverlay.classList.remove('active');
                    }, 500);
                }, 800);
            }
            
     
            function transitionBackToMain() {
                const transitionOverlay = document.getElementById('transition-overlay');
              //  transitionOverlay.classList.add('active');
                
             
                const concentricMap = document.getElementById('concentric-map');
                concentricMap.classList.add('zoom-out');
                
                
                setTimeout(() => {
                  
                    svg.selectAll("*").remove();
                    
              
                    document.querySelector('.center-circle').innerHTML = `
                        <h3>سوريا</h3>
                        <p>المركز الرئيسي</p>
                    `;
                    
                    concentricMap.classList.remove('zoom-out');
                    concentricMap.classList.add('zoom-in');
                    
                    nestingLevel = 0;
                    rotationAngle = 0;
                    drawMap();
                    document.getElementById('rotation-controls').style.display = 'flex';
                    activeSection = null;
                    
                 
                    setTimeout(() => {
                        concentricMap.classList.remove('zoom-in');
                        transitionOverlay.classList.remove('active');
                    }, 500);
                }, 800);
            }
            

            loadLicenseStatus();
            await loadData();
            setupRealtimeUpdates();
            updateLicenseUI();
            drawMap();
            
           
            window.addEventListener('beforeunload', function() {
                saveDataLocally(); 
            });
            
        
            setInterval(() => {
                if (Object.keys(sectionDatabase).length > 0) {
                    saveDataLocally();
                }
            }, 30000);
            
            document.querySelector('.center-circle').addEventListener('click', function() {
                transitionBackToMain();
            });
            document.getElementById('reset-view').addEventListener('click', function() {
                transitionBackToMain();
            });
            document.getElementById('rotate-left').addEventListener('click', function() {
                rotationAngle -= Math.PI/4;
                drawMap();
            });
            
            document.getElementById('rotate-right').addEventListener('click', function() {
                rotationAngle += Math.PI/4;
                drawMap();
            });
            document.getElementById('add-section').addEventListener('click', function() {
                if (!licenseActive) {
                    showNotification('خطأ في الترخيص', 'يجب تفعيل الترخيص أولاً');
                    return;
                }
                if (!activeSection) {
                    showNotification('خطأ', 'يجب اختيار قسم فرعي أولاً');
                    return;
                }
                document.getElementById('add-section-modal').classList.add('active');
                document.getElementById('new-section-name').value = '';
                document.getElementById('section-link').value = '';
                document.getElementById('new-section-name').focus();
            });
            document.getElementById('edit-section').addEventListener('click', function() {
                if (!licenseActive) {
                    showNotification('خطأ في الترخيص', 'يجب تفعيل الترخيص أولاً');
                    return;
                }
                if (!activeSection) {
                    showNotification('خطأ', 'يجب اختيار قسم فرعي أولاً');
                    return;
                }
                updateSectionList();
                document.getElementById('edit-section-modal').classList.add('active');
                document.getElementById('edit-section-content').value = '';
                document.getElementById('edit-section-link').value = '';
                document.querySelectorAll('.section-item').forEach(item => {
                    item.classList.remove('active');
                });
            });
            document.getElementById('close-add-modal').addEventListener('click', function() {
                document.getElementById('add-section-modal').classList.remove('active');
            });
            document.getElementById('cancel-add-btn').addEventListener('click', function() {
                document.getElementById('add-section-modal').classList.remove('active');
            });
            document.getElementById('confirm-add-btn').addEventListener('click', async function() {
                const newName = document.getElementById('new-section-name').value.trim();
                const newLink = document.getElementById('section-link').value.trim();
                if (newName) {
                    if (!sectionDatabase[activeSection]) {
                        sectionDatabase[activeSection] = {
                            sectionNames: [],
                            sectionLinks: [],
                            sectorColor: "#4ca1af"
                        };
                    }
                    sectionDatabase[activeSection].sectionNames.push(newName);
                    sectionDatabase[activeSection].sectionLinks.push(newLink);
                    if (activeSection) {
                        
                        const sectorColor = sectionDatabase[activeSection].sectorColor;
                       
                        const saved = await saveData();
                        if (saved) {
                            createNewCircleMap(activeSection, sectorColor);
                            showNotification('تمت الإضافة بنجاح!', `تم إضافة قسم جديد باسم: ${newName}`);
                        } else {
                            showNotification('خطأ في الحفظ', 'فشل في حفظ القسم الجديد');
                        }
                    }
                    document.getElementById('add-section-modal').classList.remove('active');
                } else {
                    alert('الرجاء إدخال اسم للقسم الجديد');
                }
            });
            document.getElementById('close-edit-modal').addEventListener('click', function() {
                document.getElementById('edit-section-modal').classList.remove('active');
            });
            document.getElementById('cancel-edit-btn').addEventListener('click', function() {
                document.getElementById('edit-section-modal').classList.remove('active');
            });
            document.getElementById('confirm-edit-btn').addEventListener('click', async function() {
                const selectedItem = document.querySelector('.section-item.active');
                const newName = document.getElementById('edit-section-content').value.trim();
                const newLink = document.getElementById('edit-section-link').value.trim();
                if (!selectedItem) {
                    alert('الرجاء تحديد قسم للتعديل');
                    return;
                }
                if (!newName) {
                    alert('الرجاء إدخال اسم جديد للقسم');
                    return;
                }
                const sectionId = parseInt(selectedItem.dataset.id);
                sectionDatabase[activeSection].sectionNames[sectionId] = newName;
                sectionDatabase[activeSection].sectionLinks[sectionId] = newLink;
                if (activeSection) {
                    
                    const sectorColor = sectionDatabase[activeSection].sectorColor;
                    const saved = await saveData();
                    if (saved) {
                        createNewCircleMap(activeSection, sectorColor);
                        showNotification('تم التعديل بنجاح!', `تم تحديث القسم رقم ${sectionId + 1} بنجاح`);
                    } else {
                        showNotification('خطأ في الحفظ', 'فشل في حفظ التعديلات');
                    }
                }
                document.getElementById('edit-section-modal').classList.remove('active');
            });
            function showNotification(title, message) {
                const notification = document.getElementById('notification');
                const titleElement = document.getElementById('notification-title');
                const messageElement = document.getElementById('notification-message');
                titleElement.textContent = title;
                messageElement.textContent = message;
                notification.style.display = 'block';
                setTimeout(() => {
                    notification.style.display = 'none';
                }, 3000);
            }
            function updateSectionList() {
                const sectionList = document.getElementById('section-list');
                sectionList.innerHTML = '';
                if (!activeSection) return;
                const sectionNames = sectionDatabase[activeSection].sectionNames;
                const sectionLinks = sectionDatabase[activeSection].sectionLinks;
                sectionNames.forEach((name, index) => {
                    const sectionItem = document.createElement('div');
                    sectionItem.className = 'section-item';
                    sectionItem.dataset.id = index;
                    sectionItem.innerHTML = `
                        <div>
                            <span class="section-name">${name}</span>
                            ${sectionLinks[index] ? 
                                `<span class="section-link"><i class="fas fa-link link-icon"></i> ${sectionLinks[index]}</span>` : 
                                ''}
                        </div>
                        <span class="section-id">${index + 1}</span>
                    `;
                    sectionItem.addEventListener('click', function() {
                        document.querySelectorAll('.section-item').forEach(item => {
                            item.classList.remove('active');
                        });
                        this.classList.add('active');
                        document.getElementById('edit-section-content').value = name;
                        document.getElementById('edit-section-link').value = sectionLinks[index] || '';
                    });
                    sectionList.appendChild(sectionItem);
                });
            }
        });
    </script>
</body>
</html>
-->





























































<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>خريطة منظومة الابتكار في سوريا - Startup Syria</title>
    <script src="https://d3js.org/d3.v7.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/crypto-js/4.1.1/crypto-js.min.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.1/firebase-database-compat.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        /* أنماط الانتقال الجديدة فقط */
        #concentric-map {
            transition: all 1s cubic-bezier(0.68, -0.55, 0.27, 1.55);
            transform-origin: center;
        }
        
        .transition-overlay {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(13, 27, 42, 0.8);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 1000;
            opacity: 0;
            pointer-events: none;
            transition: opacity 0.5s;
        }
        
        .transition-overlay.active {
            opacity: 1;
            pointer-events: all;
        }
        
        .transition-content {
            text-align: center;
            color: #ffd166;
            font-size: 2rem;
            font-weight: bold;
            text-shadow: 0 0 15px rgba(255, 209, 102, 0.7);
        }
        
        .transition-spinner {
            width: 60px;
            height: 60px;
            border: 5px solid rgba(76, 161, 175, 0.3);
            border-top: 5px solid #4ca1af;
            border-radius: 50%;
            margin: 20px auto;
            animation: spin 1s linear infinite;
        }
        
        .zoom-out {
            animation: zoomOut 0.8s forwards;
        }
        
        .zoom-in {
            animation: zoomIn 0.8s forwards;
        }
        
        @keyframes zoomOut {
            0% {
                transform: scale(1);
                opacity: 1;
            }
            50% {
                transform: scale(0.1);
                opacity: 0.3;
            }
            100% {
                transform: scale(0);
                opacity: 0;
            }
        }
        
        @keyframes zoomIn {
            0% {
                transform: scale(0);
                opacity: 0;
            }
            50% {
                transform: scale(0.1);
                opacity: 0.3;
            }
            100% {
                transform: scale(1);
                opacity: 1;
            }
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        /* بقية الأنماط الأصلية بدون تعديل */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        body {
            background: linear-gradient(135deg, #3d8c99 0%, #1b263b 100%);
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            padding: 20px;
            color: #fff;
            overflow-x: hidden;
        }
        
        .header {
            text-align: center;
            margin-bottom: 20px;
            padding: 20px;
            background: rgba(255, 255, 255, 0.05);
            border-radius: 15px;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
            position: relative;
            overflow: hidden;
            border: 1px solid rgba(76, 161, 175, 0.3);
            max-width: 800px;
            margin-left: auto;
            margin-right: auto;
        }
        
        .header::before {
            content: "";
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 4px;
            background: linear-gradient(90deg, #ff7e5f, #feb47b, #4ca1af, #2c3e50, #9d4edd);
        }
        
        .header h1 {
            color: #fff;
            font-size: 2.5rem;
            margin-bottom: 10px;
            font-weight: 700;
            text-shadow: 0 0 15px rgba(76, 161, 175, 0.7);
        }
        
        .header h2 {
            color: #4ca1af;
            font-size: 1.8rem;
            margin-bottom: 15px;
            font-weight: 600;
        }
        
        .header p {
            color: #a8dadc;
            font-size: 1.1rem;
            max-width: 800px;
            margin: 0 auto;
            line-height: 1.6;
        }
        
        .map-container {
            display: flex;
            justify-content: center;
            align-items: center;
            flex: 1;
            position: relative;
            margin: 30px auto;
            max-width: 800px;
            width: 100%;
            height: 80vh;
            perspective: 1000px;
        }
        
        #concentric-map {
            width: 100%;
            height: 100%;
            position: relative;
        }
        
        .center-circle {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 157px;
            height: 157px;
            background: radial-gradient(circle, #4ca1af, #2c3e50);
            border-radius: 50%;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            color: white;
            font-weight: bold;
            text-align: center;
            box-shadow: 
                0 0 30px rgba(76, 161, 175, 0.8),
                inset 0 0 20px rgba(0, 0, 0, 0.3);
            border: 3px solid rgba(255, 255, 255, 0.3);
            cursor: pointer;
            z-index: 100;
            animation: pulse 3s infinite;
            transition: all 0.5s ease;
        }
        
        .center-circle h3 {
            font-size: 1rem;
            margin-bottom: 5px;
            color: #ffd166;
        }
        
        .center-circle p {
            font-size: 0.9rem;
            padding: 0 15px;
        }
        
        @keyframes pulse {
            0% { box-shadow: 0 0 0 0 rgba(76, 161, 175, 0.7); }
            70% { box-shadow: 0 0 0 20px rgba(76, 161, 175, 0); }
            100% { box-shadow: 0 0 0 0 rgba(76, 161, 175, 0); }
        }
        
        .controls {
            display: flex;
            justify-content: center;
            gap: 15px;
            margin-bottom: 20px;
            flex-wrap: wrap;
        }
        
        .control-btn {
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid #4ca1af;
            color: #a8dadc;
            padding: 10px 20px;
            border-radius: 30px;
            cursor: pointer;
            font-size: 1rem;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .control-btn:hover {
            background: rgba(76, 161, 175, 0.3);
            transform: translateY(-2px);
        }
        
        .control-btn i {
            font-size: 1.2rem;
        }
        
        .statistics {
            display: flex;
            justify-content: center;
            gap: 20px;
            margin-top: 20px;
            flex-wrap: wrap;
        }
        
        .stat-box {
            background: rgba(255, 255, 255, 0.05);
            padding: 15px;
            border-radius: 10px;
            min-width: 150px;
            text-align: center;
            border: 1px solid rgba(76, 161, 175, 0.3);
        }
        
        .stat-value {
            font-size: 2rem;
            font-weight: bold;
            color: #4ca1af;
            margin-bottom: 5px;
        }
        
        .stat-label {
            font-size: 0.9rem;
            color: #a8dadc;
        }
        
        .subsection-item {
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .subsection-item:hover {
            opacity: 1 !important;
            filter: brightness(1.2);
        }
        
        .rotation-controls {
            display: flex;
            gap: 10px;
        }
        
        .rotation-btn {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: rgba(76, 161, 175, 0.3);
            border: 1px solid #4ca1af;
            color: #a8dadc;
            font-size: 1.5rem;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .rotation-btn:hover {
            background: rgba(76, 161, 175, 0.5);
            transform: scale(1.1);
        }
        
        .modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.7);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 2000;
            opacity: 0;
            visibility: hidden;
            transition: all 0.3s ease;
        }
        .modal.active {
            opacity: 1;
            visibility: visible;
        }
        .modal-content {
            background: linear-gradient(135deg, #1b263b 0%, #0d1b2a 100%);
            width: 90%;
            max-width: 500px;
            border-radius: 15px;
            padding: 30px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.5);
            border: 1px solid rgba(76, 161, 175, 0.5);
            position: relative;
            transform: translateY(-20px);
            transition: all 0.4s ease;
        }
        .modal.active .modal-content {
            transform: translateY(0);
        }
        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 25px;
            padding-bottom: 15px;
            border-bottom: 1px solid rgba(76, 161, 175, 0.3);
        }
        .modal-title {
            color: #ffd166;
            font-size: 1.8rem;
            font-weight: 700;
        }
        .close-btn {
            background: transparent;
            border: none;
            color: #a8dadc;
            font-size: 1.8rem;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        .close-btn:hover {
            color: #ff7e5f;
            transform: rotate(90deg);
        }
        .form-group {
            margin-bottom: 20px;
        }
        .form-group label {
            display: block;
            margin-bottom: 10px;
            color: #a8dadc;
            font-size: 1.1rem;
        }
        .form-group input, .form-group textarea, .form-group select {
            width: 100%;
            padding: 12px 15px;
            border-radius: 8px;
            border: 1px solid #4ca1af;
            background: rgba(255, 255, 255, 0.1);
            color: white;
            font-size: 1rem;
            transition: all 0.3s ease;
        }
        .form-group input:focus, .form-group textarea:focus, .form-group select:focus {
            border-color: #ffd166;
            box-shadow: 0 0 10px rgba(255, 209, 102, 0.3);
            outline: none;
        }
        .form-group textarea {
            height: 120px;
            resize: vertical;
        }
        .form-actions {
            display: flex;
            justify-content: center;
            gap: 15px;
            margin-top: 25px;
        }
        .form-btn {
            flex: 1;
            padding: 12px 20px;
            border-radius: 8px;
            border: none;
            cursor: pointer;
            font-weight: bold;
            font-size: 1.1rem;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
        }
        .form-btn.primary {
            background: linear-gradient(135deg, #4ca1af, #2c3e50);
            color: white;
        }
        .form-btn.primary:hover {
            background: linear-gradient(135deg, #3d8c99, #1b263b);
            transform: translateY(-3px);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
        }
        .form-btn.secondary {
            background: rgba(255, 255, 255, 0.1);
            color: #a8dadc;
            border: 1px solid #4ca1af;
        }  
        .form-btn.secondary:hover {
            background: rgba(76, 161, 175, 0.2);
            transform: translateY(-3px);
        }
        .notification {
            position: fixed;
            top: 20px;
            right: 20px;
            background: rgba(76, 161, 175, 0.9);
            color: white;
            padding: 15px 25px;
            border-radius: 10px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
            z-index: 3000;
            display: none;
            animation: slideIn 0.5s forwards, fadeOut 0.5s forwards 2.5s;
            max-width: 350px;
        }
        @keyframes slideIn {
            from {
                transform: translateX(100%);
                opacity: 0;
            }
            to {
                transform: translateX(0);
                opacity: 1;
            }
        }
        @keyframes fadeOut {
            from {
                opacity: 1;
            }
            to {
                opacity: 0;
            }
        }
        .notification-content {
            display: flex;
            align-items: center;
            gap: 15px;
        }
        .notification-icon {
            font-size: 2rem;
            color: #ffd166;
        }
        .notification-text h3 {
            margin-bottom: 5px;
            font-size: 1.2rem;
        }
        .notification-text p {
            font-size: 1rem;
            opacity: 0.9;
        }
        .section-list {
            max-height: 300px;
            overflow-y: auto;
            margin-bottom: 20px;
            border: 1px solid rgba(76, 161, 175, 0.3);
            border-radius: 8px;
            padding: 10px;
        }
        .section-item {
            padding: 12px;
            margin-bottom: 8px;
            background: rgba(255, 255, 255, 0.05);
            border-radius: 6px;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }   
        .section-item:hover {
            background: rgba(76, 161, 175, 0.2);
            transform: translateX(-5px);
        }
        .section-item.active {
            background: rgba(76, 161, 175, 0.3);
            border-left: 4px solid #ffd166;
        }        
        .section-name {
            font-weight: 600;
            color: #a8dadc;
        }
        .section-id {
            background: rgba(255, 209, 102, 0.2);
            color: #ffd166;
            padding: 3px 8px;
            border-radius: 4px;
            font-size: 0.9rem;
        }
        .section-link {
            font-size: 0.85rem;
            color: #4ca1af;
            margin-top: 5px;
            display: block;
            overflow: hidden;
            text-overflow: ellipsis;
            white-space: nowrap;
            direction: ltr;
            text-align: left;
        }
        .link-icon {
            color: #ff7e5f;
            margin-left: 5px;
        }
        .link-button {
            cursor: pointer;
            transition: all 0.3s ease;
            pointer-events: all;
        }
        .link-icon {
            font-size: 14px;
            fill: #4ca1af;
            transition: all 0.3s ease;
        }
        .link-button:hover .link-icon {
            fill: #ffd166;
            transform: scale(1.2);
        }
        .link-icon-text {
            font-family: 'Font Awesome 5 Free';
            font-weight: 900;
            font-size: 14px;
            fill: #4ca1af;
            transition: all 0.3s ease;
        }   
        .database-info {
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 10px;
            margin-top: 15px;
            font-size: 0.9rem;
            color: #4ca1af;
        }
        .db-icon {
            color: #ffd166;
        }
        .title-row {
            display: flex;
            justify-content: space-between;
            width: 100%;
            max-width: 800px;
            margin: 0 auto 20px;
        }
        .title-box {
            background: rgba(255, 255, 255, 0.1);
            padding: 10px 20px;
            border-radius: 8px;
            font-size: 1.2rem;
            font-weight: 600;
            color: #a8dadc;
        }
        .subsection-label {
            position: absolute;
            text-align: center;
            font-size: 10px;
            font-weight: bold;
            z-index: 80;
            pointer-events: none;
            fill: #ffffff;
            text-shadow: 0 0 2px rgba(0,0,0,0.8);
        }
        .inner-label {
            position: absolute;
            text-align: center;
            font-size: 13px;
            font-weight: bold;
            z-index: 90;
            pointer-events: none;
            line-height: 1.3;
        }
        .license-control {
            display: flex;
            justify-content: center;
            margin-bottom: 15px;
        }
        .license-input {
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid #4ca1af;
            color: white;
            padding: 10px 15px;
            border-radius: 30px;
            width: 200px;
            text-align: center;
            font-size: 1rem;
            transition: all 0.3s ease;
            margin-right: 10px;
        }
        .license-input:focus {
            border-color: #ffd166;
            box-shadow: 0 0 10px rgba(255, 209, 102, 0.3);
            outline: none;
        } 
        .license-btn {
            background: linear-gradient(135deg, #4ca1af, #2c3e50);
            border: none;
            color: white;
            padding: 10px 20px;
            border-radius: 30px;
            cursor: pointer;
            font-weight: bold;
            transition: all 0.3s ease;
        }
        .license-btn:hover {
            background: linear-gradient(135deg, #3d8c99, #1b263b);
            transform: translateY(-2px);
        }       
        .license-status {
            text-align: center;
            margin-bottom: 10px;
            font-size: 0.95rem;
            padding: 8px 16px;
            border-radius: 20px;
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid rgba(76, 161, 175, 0.2);
            display: inline-block;
            backdrop-filter: blur(10px);
            transition: all 0.3s ease;
        }
        .license-active {
            color: #06d6a0;
        }
        .license-inactive {
            color: #ff7e5f;
        } 
        
        .team-section {
            margin-top: 30px;
            padding: 30px;
            background: rgba(255, 255, 255, 0.05);
            border-radius: 15px;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
            border: 1px solid rgba(76, 161, 175, 0.3);
            max-width: 1000px;
            margin-left: auto;
            margin-right: auto;
        }
        
        .team-title {
            text-align: center;
            color: #ffd166;
            font-size: 2rem;
            font-weight: bold;
            margin-bottom: 30px;
            text-shadow: 0 0 15px rgba(255, 209, 102, 0.7);
        }
        
        .team-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 25px;
            margin-top: 20px;
        }
        
        .team-member {
            background: rgba(255, 255, 255, 0.08);
            padding: 25px;
            border-radius: 12px;
            border: 1px solid rgba(76, 161, 175, 0.2);
            transition: all 0.3s ease;
            text-align: center;
        }
        
        .team-member:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 25px rgba(76, 161, 175, 0.3);
            border-color: rgba(76, 161, 175, 0.5);
        }
        
        .member-name {
            color: #4ca1af;
            font-size: 1.3rem;
            font-weight: bold;
            margin-bottom: 8px;
        }
        
        .member-role {
            color: #a8dadc;
            font-size: 1rem;
            margin-bottom: 15px;
            font-style: italic;
        }
        
        .member-description {
            color: #a8dadc;
            font-size: 0.9rem;
            line-height: 1.5;
            margin-bottom: 20px;
        }
        
        .social-links {
            display: flex;
            justify-content: center;
            gap: 15px;
        }
        
        .social-link {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            width: 40px;
            height: 40px;
            background: rgba(76, 161, 175, 0.2);
            border: 1px solid rgba(76, 161, 175, 0.3);
            border-radius: 50%;
            color: #4ca1af;
            text-decoration: none;
            transition: all 0.3s ease;
            font-size: 1.2rem;
        }
        
        .social-link:hover {
            background: rgba(76, 161, 175, 0.4);
            color: #ffd166;
            transform: scale(1.1);
            box-shadow: 0 5px 15px rgba(76, 161, 175, 0.3);
        }
        
        .social-link.linkedin:hover {
            background: rgba(0, 119, 181, 0.3);
            border-color: #0077b5;
        }
        
        .social-link.github:hover {
            background: rgba(51, 51, 51, 0.3);
            border-color: #333;
        }
        
        .social-link.twitter:hover {
            background: rgba(29, 161, 242, 0.3);
            border-color: #1da1f2;
        }
        
        .social-link.email:hover {
            background: rgba(234, 67, 53, 0.3);
            border-color: #ea4335;
        }
        
        .suggestion-form .form-group {
            margin-bottom: 15px;
        }
        
        .suggestion-form label {
            display: block;
            margin-bottom: 8px;
            color: #a8dadc;
            font-weight: 500;
        }
        
        .suggestion-form input, 
        .suggestion-form textarea, 
        .suggestion-form select {
            width: 100%;
            padding: 12px 15px;
            border-radius: 8px;
            border: 1px solid #4ca1af;
            background: rgba(255, 255, 255, 0.1);
            color: white;
            font-size: 1rem;
            transition: all 0.3s ease;
        }
        
        .suggestion-form input:focus, 
        .suggestion-form textarea:focus, 
        .suggestion-form select:focus {
            border-color: #ffd166;
            box-shadow: 0 0 10px rgba(255, 209, 102, 0.3);
            outline: none;
        }
        
        .suggestion-form textarea {
            height: 120px;
            resize: vertical;
        }
        
        .suggestion-form .form-actions {
            display: flex;
            justify-content: center;
            gap: 15px;
            margin-top: 20px;
        }
        
        .suggestion-form .form-btn {
            padding: 12px 25px;
            border-radius: 8px;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .suggestion-form .submit-btn {
            background: linear-gradient(135deg, #4ca1af, #2c3e50);
            color: white;
            border: none;
        }
        
        .suggestion-form .submit-btn:hover {
            background: linear-gradient(135deg, #3d8c99, #1b263b);
            transform: translateY(-3px);
        }
        
        .suggestion-form .cancel-btn {
            background: rgba(255, 255, 255, 0.1);
            color: #a8dadc;
            border: 1px solid #4ca1af;
        }
        
        .suggestion-form .cancel-btn:hover {
            background: rgba(76, 161, 175, 0.2);
            transform: translateY(-3px);
        }
        
        .control-btn.suggest-btn {
            background: rgba(6, 214, 160, 0.2);
            border-color: #06d6a0;
        }
        
        .control-btn.suggest-btn:hover {
            background: rgba(6, 214, 160, 0.3);
        }
        
        .control-btn.suggest-btn i {
            color: #06d6a0;
        }

        .clickable-text {
            cursor: pointer;
            transition: all 0.3s ease;
        }
        .clickable-text:hover {
            fill: #ffd166 !important;
            font-size: 11px !important;
            text-shadow: 0 0 8px rgba(255, 209, 102, 0.7);
        }
        
        p {
        display: block;
        margin-block-start: 0.1em;
        margin-block-end: 1em;
        margin-inline-start: 0px;
        margin-inline-end: 0px;
        unicode-bidi: isolate;
        }
        .highlight {
        color: #4ca1af;
        font-weight: 600;
        text-shadow: 0 0 8px rgba(76, 161, 175, 0.7);
        }

        .footer {
        text-align: center;
        margin-top: 20px;
        padding: 20px;
        background: rgba(255, 255, 255, 0.05);
        border-radius: 15px;
        box-shadow: 0 4px 15px rgba(0, 0, 0, 0.3);
        color: #a8dadc;
        font-size: 1.1rem;
        border: 1px solid rgba(76, 161, 175, 0.3);
        max-width: 800px;
        margin-left: auto;
        margin-right: auto;
        }
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        @media (max-width: 768px) {
            .header h1 {
                font-size: 2rem;
            }
            
            .header h2 {
                font-size: 1.5rem;
            }
            
            .header p {
                font-size: 1rem;
            }
            
            .map-container {
                height: 70vh;
            }
            
            .center-circle {
                width: 120px;
                height: 120px;
            }
            
            .center-circle h3 {
                font-size: 1.2rem;
            }
            
            .center-circle p {
                font-size: 0.5rem;
            }
            
            .title-box {
                font-size: 1rem;
                padding: 8px 15px;
            }
            
            .sector-label {
                font-size: 16px;
            }
            
            .inner-label {
                font-size: 11px;
            }
            
            .subsection-label {
                font-size: 8px;
            }
        }
        
        @media (max-width: 480px) {
            .map-container {
                height: 60vh;
            }
            
            .center-circle {
                width: 70px;
                height: 70px;
            }
            
            .center-circle h3 {
                font-size: 8px;
            }
            
            .inner-label {
                font-size: 10px;
            }
            
            .subsection-label {
                font-size: 6px;
            }


            .loading-suggestions {
            text-align: center;
            padding: 20px;
            color: #4ca1af;
            font-size: 1.2rem;
        }
        
        .suggestion-item {
            background: rgba(255, 255, 255, 0.05);
            border-radius: 8px;
            padding: 15px;
            margin-bottom: 15px;
            border: 1px solid rgba(76, 161, 175, 0.3);
            transition: all 0.3s ease;
        }
        
        .suggestion-item:hover {
            transform: translateY(-3px);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
            border-color: rgba(76, 161, 175, 0.5);
        }
        
        .suggestion-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 10px;
            padding-bottom: 10px;
            border-bottom: 1px solid rgba(76, 161, 175, 0.2);
        }
        
        .suggestion-title {
            font-weight: bold;
            font-size: 1.2rem;
            color: #ffd166;
        }
        
        .suggestion-field {
            background: rgba(76, 161, 175, 0.2);
            color: #4ca1af;
            padding: 3px 10px;
            border-radius: 15px;
            font-size: 0.9rem;
        }
        
        .suggestion-detail {
            margin-bottom: 8px;
            display: flex;
        }
        
        .suggestion-label {
            font-weight: bold;
            min-width: 120px;
            color: #a8dadc;
        }
        
        .suggestion-value {
            flex: 1;
            color: #ffffff;
        }
        
        .suggestion-website {
            color: #4ca1af;
            text-decoration: none;
            transition: all 0.3s ease;
        }
        
        .suggestion-website:hover {
            color: #ffd166;
            text-decoration: underline;
        }
        
        .suggestion-status {
            margin-top: 15px;
            padding: 8px 15px;
            border-radius: 20px;
            display: inline-block;
            font-weight: bold;
        }
        
        .status-pending {
            background: rgba(255, 209, 102, 0.2);
            color: #ffd166;
        }
        
        .status-approved {
            background: rgba(6, 214, 160, 0.2);
            color: #06d6a0;
        }
        
        .status-rejected {
            background: rgba(239, 71, 111, 0.2);
            color: #ef476f;
        }
        
        .suggestion-date {
            color: #a8dadc;
            font-size: 0.9rem;
            margin-top: 10px;
            text-align: left;
        }



















        }
    </style>
</head>
<body>
    <div class="title-row">
        <div class="title-box">Question Support</div>
        <div class="title-box">Strategy Syria</div>
    </div>
    <div class="header">
        <h1>خريطة منظومة الابتكار في سوريا</h1>
        <h2>Startup Syria</h2>
        <p>نظام إدارة متكامل مع تأثيرات انتقالية متقدمة</p>
    </div>
    <div class="license-control">
        <input type="password" class="license-input" id="license-input" placeholder="أدخل مفتاح الترخيص">
        <button class="license-btn" id="license-btn">تفعيل الترخيص</button>
    </div>
    <div class="license-status" id="license-status">
        <span class="license-inactive"><i class="fas fa-times-circle"></i> الترخيص غير مفعل</span>
    </div>
    
    <div class="controls">
        <button class="control-btn" id="reset-view">
            <i class="fas fa-sync-alt"></i> إعادة تعيين العرض
        </button>
        <button class="control-btn" id="add-section">
            <i class="fas fa-plus-circle"></i> إضافة قسم جديد
        </button>
        <button class="control-btn" id="edit-section">
            <i class="fas fa-edit"></i> تعديل الأقسام
        </button>
        <div class="rotation-controls" id="rotation-controls">
            <div class="rotation-btn" id="rotate-left" title="تدوير لليسار">
                <i class="fas fa-undo"></i>
            </div>
            <div class="rotation-btn" id="rotate-right" title="تدوير لليمين">
                <i class="fas fa-redo"></i>
            </div>
        </div>

        <button class="control-btn suggestions-btn" id="view-suggestions" style="display: none;">
            <i class="fas fa-list-alt"></i> الاقتراحات
        </button>
        
        <!-- نافذة منبثقة جديدة لعرض الاقتراحات -->
        <div class="modal" id="suggestions-modal">
            <div class="modal-content">
                <div class="modal-header">
                    <h3 class="modal-title">قائمة الاقتراحات المقدمة</h3>
                    <button class="close-btn" id="close-suggestions-modal">
                        <i class="fas fa-times"></i>
                    </button>
                </div>
                <div class="suggestions-container">
                    <div class="suggestions-list" id="suggestions-list">
                        <!-- سيتم ملؤها ديناميكياً -->
                    </div>
                </div>
                <div class="form-actions">
                    <button class="form-btn secondary" id="close-suggestions-btn">
                        <i class="fas fa-times"></i> إغلاق
                    </button>
                </div>
            </div>
        </div>

        <div class="modal" id="suggest-company-modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 class="modal-title">اقتراح شركة جديدة</h3>
                <button class="close-btn" id="close-suggest-modal">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <form class="suggestion-form">
                <div class="form-group">
                    <label for="company-name">اسم الشركة *</label>
                    <input type="text" id="company-name" required placeholder="أدخل اسم الشركة">
                </div>
                
                <div class="form-group">
                    <label for="company-field">مجال الشركة *</label>
                    <select id="company-field" required>
                        <option value="">اختر مجال الشركة</option>
                        <option value="تكنولوجيا">تكنولوجيا</option>
                        <option value="تمويل">تمويل واستثمار</option>
                        <option value="تعليم">تعليم وبحث</option>
                        <option value="بنية تحتية">بنية تحتية</option>
                        <option value="دعم">دعم واستشارات</option>
                        <option value="سياسات">سياسات وتنظيم</option>
                        <option value="أخرى">مجال آخر</option>
                    </select>
                </div>
                
                <div class="form-group">
                    <label for="company-description">وصف عن الشركة *</label>
                    <textarea id="company-description" required placeholder="أدخل وصفاً مختصراً عن الشركة ونشاطها"></textarea>
                </div>
                
                <div class="form-group">
                    <label for="company-location">موقع الشركة *</label>
                    <input type="text" id="company-location" required placeholder="المدينة والمنطقة">
                </div>
                
                <div class="form-group">
                    <label for="company-website">رابط موقع الشركة (اختياري)</label>
                    <input type="url" id="company-website" placeholder="https://example.com">
                </div>
                
                <div class="form-actions">
                    <button type="button" class="form-btn cancel-btn" id="cancel-suggest-btn">
                        إلغاء الطلب
                    </button>
                    <button type="submit" class="form-btn submit-btn">
                        <i class="fas fa-paper-plane"></i> إرسال الاقتراح
                    </button>
                </div>
            </form>
        </div>
    </div>
    </div>
    
    <div class="modal" id="suggest-company-modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 class="modal-title">اقتراح شركة جديدة</h3>
                <button class="close-btn" id="close-suggest-modal">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <form class="suggestion-form">
                <div class="form-group">
                    <label for="company-name">اسم الشركة *</label>
                    <input type="text" id="company-name" required placeholder="أدخل اسم الشركة">
                </div>
                
                <div class="form-group">
                    <label for="company-field">مجال الشركة *</label>
                    <select id="company-field" required>
                        <option value="">اختر مجال الشركة</option>
                        <option value="تكنولوجيا">تكنولوجيا</option>
                        <option value="تمويل">تمويل واستثمار</option>
                        <option value="تعليم">تعليم وبحث</option>
                        <option value="بنية تحتية">بنية تحتية</option>
                        <option value="دعم">دعم واستشارات</option>
                        <option value="سياسات">سياسات وتنظيم</option>
                        <option value="أخرى">مجال آخر</option>
                    </select>
                </div>
                
                <div class="form-group">
                    <label for="company-description">وصف عن الشركة *</label>
                    <textarea id="company-description" required placeholder="أدخل وصفاً مختصراً عن الشركة ونشاطها"></textarea>
                </div>
                
                <div class="form-group">
                    <label for="company-location">موقع الشركة *</label>
                    <input type="text" id="company-location" required placeholder="المدينة والمنطقة">
                </div>
                
                <div class="form-group">
                    <label for="company-website">رابط موقع الشركة (اختياري)</label>
                    <input type="url" id="company-website" placeholder="https://example.com">
                </div>
                
                <div class="form-actions">
                    <button type="button" class="form-btn cancel-btn" id="cancel-suggest-btn">
                        إلغاء الطلب
                    </button>
                    <button type="submit" class="form-btn submit-btn">
                        <i class="fas fa-paper-plane"></i> إرسال الاقتراح
                    </button>
                </div>
            </form>
        </div>
    </div>

    <div class="map-container">
        <div class="transition-overlay" id="transition-overlay">
            <div class="transition-content">
                <div class="transition-spinner"></div>
            <!-- <div>جاري تحميل البيانات...</div>-->
            </div>
        </div>
        <div id="concentric-map"></div>
        <div class="center-circle">
            <h3>سوريا</h3>
            <p>المركز الرئيسي</p>
        </div>
    </div>
    
    <div class="notification" id="notification">
        <div class="notification-content">
            <div class="notification-icon">
                <i class="fas fa-check-circle"></i>
            </div>
            <div class="notification-text">
                <h3 id="notification-title">تمت العملية بنجاح!</h3>
                <p id="notification-message">تم إضافة قسم جديد بنجاح</p>
            </div>
        </div>
    </div>
    
    <div class="team-section">
        <h2 class="team-title">فريق العمل</h2>
        <div class="team-grid">
            <div class="team-member">
                <div class="member-name">أحمد محمد</div>
                <div class="member-role">مطور واجهات أمامية</div>
                <div class="member-description">
                    متخصص في تطوير واجهات المستخدم باستخدام React و D3.js، مع خبرة في تصميم التفاعلات المتقدمة والرسوم البيانية التفاعلية.
                </div>
                <div class="social-links">
                    <a href="https://linkedin.com/in/ahmed-mohamed" target="_blank" class="social-link linkedin">
                        <i class="fab fa-linkedin-in"></i>
                    </a>
                    <a href="https://github.com/ahmed-mohamed" target="_blank" class="social-link github">
                        <i class="fab fa-github"></i>
                    </a>
                    <a href="mailto:ahmed@startupsyria.com" class="social-link email">
                        <i class="fas fa-envelope"></i>
                    </a>
                </div>
            </div>
            
            <div class="team-member">
                <div class="member-name">سارة أحمد</div>
                <div class="member-role">مصممة UX/UI</div>
                <div class="member-description">
                    خبيرة في تصميم تجربة المستخدم وواجهات التطبيقات، متخصصة في إنشاء تصاميم بديهية وجذابة تركز على احتياجات المستخدم.
                </div>
                <div class="social-links">
                    <a href="https://linkedin.com/in/sara-ahmed" target="_blank" class="social-link linkedin">
                        <i class="fab fa-linkedin-in"></i>
                    </a>
                    <a href="https://github.com/sara-ahmed" target="_blank" class="social-link github">
                        <i class="fab fa-github"></i>
                    </a>
                    <a href="https://twitter.com/sara_ahmed" target="_blank" class="social-link twitter">
                        <i class="fab fa-twitter"></i>
                    </a>
                </div>
            </div>
            
            <div class="team-member">
                <div class="member-name">محمد علي</div>
                <div class="member-role">مطور خلفي</div>
                <div class="member-description">
                    متخصص في تطوير الخوادم وقواعد البيانات، خبير في Firebase و Node.js مع التركيز على الأمان وقابلية التوسع.
                </div>
                <div class="social-links">
                    <a href="https://linkedin.com/in/mohamed-ali" target="_blank" class="social-link linkedin">
                        <i class="fab fa-linkedin-in"></i>
                    </a>
                    <a href="https://github.com/mohamed-ali" target="_blank" class="social-link github">
                        <i class="fab fa-github"></i>
                    </a>
                    <a href="mailto:mohamed@startupsyria.com" class="social-link email">
                        <i class="fas fa-envelope"></i>
                    </a>
                </div>
            </div>
            
            <div class="team-member">
                <div class="member-name">فاطمة حسن</div>
                <div class="member-role">محللة بيانات</div>
                <div class="member-description">
                    خبيرة في تحليل البيانات وإنشاء التقارير، متخصصة في استخراج الرؤى من البيانات المعقدة وتحويلها إلى معلومات قابلة للتنفيذ.
                </div>
                <div class="social-links">
                    <a href="https://linkedin.com/in/fatima-hassan" target="_blank" class="social-link linkedin">
                        <i class="fab fa-linkedin-in"></i>
                    </a>
                    <a href="https://twitter.com/fatima_hassan" target="_blank" class="social-link twitter">
                        <i class="fab fa-twitter"></i>
                    </a>
                    <a href="mailto:fatima@startupsyria.com" class="social-link email">
                        <i class="fas fa-envelope"></i>
                    </a>
                </div>
            </div>
        </div>
    </div>

    <div class="statistics">
        <div class="stat-box">
            <div class="stat-value">42</div>
            <div class="stat-label">منظمة داعمة</div>
        </div>
        <div class="stat-box">
            <div class="stat-value">18</div>
            <div class="stat-label">حاضنة أعمال</div>
        </div>
        <div class="stat-box">
            <div class="stat-value">127</div>
            <div class="stat-label">مشروع ناشئ</div>
        </div>
        <div class="stat-box">
            <div class="stat-value">$5.2M</div>
            <div class="stat-label">استثمارات</div>
        </div>
    </div>
    <div class="footer">
        <div class="database-info">
            <i class="fas fa-database db-icon"></i>
            <span>جميع التغييرات محفوظة في قاعدة البيانات المحلية - آخر حفظ: <span id="last-save-time">لم يتم الحفظ بعد</span></span>
        </div>
        <p>Source: <span class="highlight">Data Collected by Startup Syria 2025</span></p>
    </div>
    
    <div class="modal" id="add-section-modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 class="modal-title">إضافة قسم جديد</h3>
                <button class="close-btn" id="close-add-modal">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="form-group">
                <label for="new-section-name">اسم القسم الجديد</label>
                <input type="text" id="new-section-name" placeholder="أدخل اسم القسم الجديد هنا">
            </div>
            <div class="form-group">
                <label for="section-link">رابط القسم (اختياري)</label>
                <input type="url" id="section-link" placeholder="https://example.com">
            </div>
            <div class="form-actions">
                <button class="form-btn secondary" id="cancel-add-btn">
                    <i class="fas fa-times"></i> إلغاء
                </button>
                <button class="form-btn primary" id="confirm-add-btn">
                    <i class="fas fa-plus"></i> إضافة القسم
                </button>
            </div>
        </div>
    </div>
    
    <div class="modal" id="edit-section-modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 class="modal-title">تعديل الأقسام</h3>
                <button class="close-btn" id="close-edit-modal">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="form-group">
                <label for="section-select">اختر القسم للتعديل</label>
                <div class="section-list" id="section-list"></div>
            </div>
            <div class="form-group">
                <label for="edit-section-content">اسم القسم الجديد</label>
                <input type="text" id="edit-section-content" placeholder="أدخل الاسم الجديد للقسم">
            </div>
            <div class="form-group">
                <label for="edit-section-link">رابط القسم</label>
                <input type="url" id="edit-section-link" placeholder="https://example.com">
            </div>
            <div class="form-actions">
                <button class="form-btn secondary" id="cancel-edit-btn">
                    <i class="fas fa-times"></i> إلغاء
                </button>
                <button class="form-btn primary" id="confirm-edit-btn">
                    <i class="fas fa-save"></i> حفظ التغييرات
                </button>
            </div>
        </div>
    </div>
    <script>
        document.addEventListener('DOMContentLoaded', async function() {
            // تكوين Firebase
            const firebaseConfig = {
                apiKey: "AIzaSyAFwUMYczS1GbGzfa56blHRpS6hjY30DL8",
                authDomain: "startup-syria-map.firebaseapp.com",
                projectId: "startup-syria-map",
                storageBucket: "startup-syria-map.appspot.com",
                messagingSenderId: "190890951419",
                appId: "1:190890951419:web:dd712fbbca9c20ba31a65e",
                databaseURL: "https://startup-syria-map-default-rtdb.firebaseio.com"
            };
            
            // تهيئة Firebase
            firebase.initializeApp(firebaseConfig);
            const database = firebase.database();
            
            const width = 800;
            const height = 800;
            const centerX = width / 2;
            const centerY = height / 2;
            const svg = d3.select("#concentric-map")
                .append("svg")
                .attr("width", "100%")
                .attr("height", "100%")
                .attr("viewBox", `0 0 ${width} ${height}`)
                .attr("preserveAspectRatio", "xMidYMid meet");
            
            // الحلقات في الدائرة الرئيسية - تم تكبير الحلقة الخارجية
            const rings = [
                { id: 1, innerRadius: 50, outerRadius: 150, name: "الحلقة الداخلية", color: "rgba(76, 161, 175, 0.3)" },
                { id: 2, innerRadius: 150, outerRadius: 350, name: "الحلقة الخارجية", color: "rgba(255, 126, 95, 0.3)" }
            ];
            
            const sectors = [
                { 
                    id: 1, 
                    name: "Ideation Support", 
                    color: "#008080", 
                    startAngle: 0, 
                    endAngle: 2*Math.PI/5, 
                    subsections: [
                        "Incubators",
                        "Venture Studios",
                        "Competition Events",
                        "Mentorship Programs",
                        "Academic Institutions",
                        "Academic Institutions",
                        "Talent Development"
                    ]
                },
                { 
                    id: 2, 
                    name: "Operation, Growth, and Markets", 
                    color: "#ff6600", 
                    startAngle: 2*Math.PI/5, 
                    endAngle: 4*Math.PI/5, 
                    subsections: [
                        "Co-working Spaces",
                        "Research and Development Labs",
                        "Startup Hiring",
                        "Startup Accounting",
                        "Startup Marketing",
                        "Women's Support"
                    ]
                },
                { 
                    id: 3, 
                    name: "Regulations and Government Support", 
                    color: "#ffdd33", 
                    startAngle: 4*Math.PI/5, 
                    endAngle: 6*Math.PI/5, 
                    subsections: [
                        "Governmental Support",
                        "Legal Support",
                        "Banks"
                    ]
                },
                { 
                    id: 4, 
                    name: "Networking and Cultures", 
                    color: "#cc3366", 
                    startAngle: 6*Math.PI/5, 
                    endAngle: 8*Math.PI/5, 
                    subsections: [
                        "Media",
                        "Events",
                        "NGOs",
                        "Startup Podcasts",
                      //  "Innovation Hub" 
                    ]
                },
                { 
                    id: 5, 
                    name: "Funding", 
                    color: "#0066cc", 
                    startAngle: 8*Math.PI/5, 
                    endAngle: 2*Math.PI, 
                    subsections: [
                        "Financial Development Institutions",
                        "TVenture Capitals",
                        "Private Equity",
                        "Angel Investors",
                        "Crowdfunding",
                        "Family Offices",
                        "Fund of Funds"
                    ]
                }
            ];
            
            let activeSection = null;
            let rotationAngle = 0;
            let sectionCount = 8;
            let sectionDatabase = {};
            let nestingLevel = 0;
            const MAX_NESTING_LEVEL = 1;
            let licenseActive = false;
            
            const licenseInput = document.getElementById('license-input');
            const licenseBtn = document.getElementById('license-btn');
            const licenseStatus = document.getElementById('license-status');
            const lastSaveTimeElement = document.getElementById('last-save-time');
            
            // تحديث وقت آخر حفظ
            function updateLastSaveTime() {
                const now = new Date();
                lastSaveTimeElement.textContent = now.toLocaleTimeString('ar-SA');
            }
            
            function setupModalEvents() {
            // أحداث نافذة اقتراح الشركة
            document.getElementById('close-suggest-modal').addEventListener('click', function() {
                document.getElementById('suggest-company-modal').classList.remove('active');
            });
            
            document.getElementById('cancel-suggest-btn').addEventListener('click', function() {
                document.getElementById('suggest-company-modal').classList.remove('active');
            });
            
            // أحداث النوافذ الأخرى
            document.getElementById('close-add-modal').addEventListener('click', function() {
                document.getElementById('add-section-modal').classList.remove('active');
            });
            
            document.getElementById('cancel-add-btn').addEventListener('click', function() {
                document.getElementById('add-section-modal').classList.remove('active');
            });
            
            document.getElementById('close-edit-modal').addEventListener('click', function() {
                document.getElementById('edit-section-modal').classList.remove('active');
            });
            
            document.getElementById('cancel-edit-btn').addEventListener('click', function() {
                document.getElementById('edit-section-modal').classList.remove('active');
            });
            
            document.getElementById('close-suggestions-modal').addEventListener('click', function() {
                document.getElementById('suggestions-modal').classList.remove('active');
            });
            
            document.getElementById('close-suggestions-btn').addEventListener('click', function() {
                document.getElementById('suggestions-modal').classList.remove('active');
            });
        }


            // تحميل حالة الترخيص من localStorage
            function loadLicenseStatus() {
                const savedLicense = localStorage.getItem('innovationMapLicense');
                if (savedLicense) {
                    try {
                        const licenseData = JSON.parse(savedLicense);
                        licenseActive = licenseData.active || false;
                    } catch (error) {
                        console.error('Error loading license status:', error);
                        licenseActive = false;
                    }
                }
            }
            
            // حفظ حالة الترخيص في localStorage
            function saveLicenseStatus() {
                try {
                    const licenseData = {
                        active: licenseActive,
                        timestamp: Date.now()
                    };
                    localStorage.setItem('innovationMapLicense', JSON.stringify(licenseData));
                } catch (error) {
                    console.error('Error saving license status:', error);
                }
            }
            
            function updateLicenseUI() {
                if (licenseActive) {
                    licenseStatus.innerHTML = '<span class="license-active"><i class="fas fa-check-circle"></i> الترخيص مفعل</span>';
                    document.getElementById('add-section').style.display = 'flex';
                    document.getElementById('edit-section').style.display = 'flex';
                    document.getElementById('view-suggestions').style.display = 'flex'; // إظهار زر الاقتراحات
                    
                    // إضافة زر اقترح شركة فقط إذا لم يضاف من قبل
                    if (!document.getElementById('suggest-company')) {
                        const suggestBtn = document.createElement('button');
                        suggestBtn.className = 'control-btn suggest-btn';
                        suggestBtn.id = 'suggest-company';
                        suggestBtn.innerHTML = '<i class="fas fa-lightbulb"></i> اقترح شركة';
                        document.querySelector('.controls').appendChild(suggestBtn);
                        
                        // إضافة حدث النقر لفتح نافذة الاقتراح
                        suggestBtn.addEventListener('click', function() {
                            document.getElementById('suggest-company-modal').classList.add('active');
                            document.getElementById('company-name').value = '';
                            document.getElementById('company-field').value = '';
                            document.getElementById('company-description').value = '';
                            document.getElementById('company-location').value = '';
                            document.getElementById('company-website').value = '';
                            document.getElementById('company-name').focus();
                        });
                    }
                } else {
                    licenseStatus.innerHTML = '<span class="license-inactive"><i class="fas fa-times-circle"></i> الترخيص غير مفعل</span>';
                    document.getElementById('add-section').style.display = 'none';
                    document.getElementById('edit-section').style.display = 'none';
                    document.getElementById('view-suggestions').style.display = 'none'; // إخفاء زر الاقتراحات
                    
                    // إزالة زر اقترح شركة إذا كان موجوداً
                    const suggestBtn = document.getElementById('suggest-company');
                    if (suggestBtn) {
                        suggestBtn.remove();
                    }
                }
            }
            
            async function verifyLicenseKey(key) {
                return new Promise((resolve) => {
                    setTimeout(() => {
                        const hashedKey = CryptoJS.SHA256(key).toString();
                        const validKeys = [
                            "42281dc0e8dbaab0cded0057f015964d8738477fdcd4c25480b4a95bdb6c0f4b", // "startup-syria-2025"
                            "a665a45920422f9d417e4867efdc4fb8a04a1f3fff1fa07e998e86f7f7a27ae3", // "hello"
                            "ef2d127de37b942baad06145e54b0c619a1f22327b2ebbcfbec78f5564afe39d"  // "test123"
                        ];
                        resolve(validKeys.includes(hashedKey));
                    }, 500);
                });
            }
            
            const suggestionsBtn = document.getElementById('view-suggestions');
    
            // وظائف للتحكم بنافذة الاقتراحات
            document.getElementById('view-suggestions').addEventListener('click', function() {
                document.getElementById('suggestions-modal').classList.add('active');
                loadSuggestions();
            });
            
            document.getElementById('close-suggestions-modal').addEventListener('click', function() {
                document.getElementById('suggestions-modal').classList.remove('active');
            });
            
            document.getElementById('close-suggestions-btn').addEventListener('click', function() {
                document.getElementById('suggestions-modal').classList.remove('active');
            });
            
              // تحميل الاقتراحات من Firebase
              function loadSuggestions() {
                const suggestionsList = document.getElementById('suggestions-list');
                suggestionsList.innerHTML = '<div class="loading-suggestions"><i class="fas fa-spinner fa-spin"></i> جاري تحميل الاقتراحات...</div>';
                
                const suggestionsRef = database.ref('suggestions');
                suggestionsRef.once('value')
                    .then((snapshot) => {
                        suggestionsList.innerHTML = '';
                        const suggestionsData = snapshot.val();
                        
                        if (!suggestionsData) {
                            suggestionsList.innerHTML = `
                                <div class="no-suggestions">
                                    <i class="fas fa-inbox" style="font-size: 3rem; margin-bottom: 15px;"></i>
                                    <p>لا توجد اقتراحات متاحة حالياً</p>
                                    <p>كن أول من يقترح شركة جديدة!</p>
                                </div>
                            `;
                            return;
                        }
                        
                        const suggestions = [];
                        snapshot.forEach((childSnapshot) => {
                            const suggestion = childSnapshot.val();
                            suggestion.id = childSnapshot.key; // إضافة المعرف الفريد
                            suggestions.push(suggestion);
                        });
                        
                        // ترتيب الاقتراحات من الأحدث إلى الأقدم
                        suggestions.sort((a, b) => new Date(b.timestamp) - new Date(a.timestamp));
                        
                        suggestions.forEach((suggestion) => {
                            const suggestionItem = document.createElement('div');
                            suggestionItem.className = 'suggestion-item';
                            suggestionItem.dataset.id = suggestion.id;
                            
                            // تنسيق تاريخ الاقتراح
                            const date = new Date(suggestion.timestamp);
                            const formattedDate = date.toLocaleDateString('ar-SA', {
                                year: 'numeric',
                                month: 'long',
                                day: 'numeric',
                                hour: '2-digit',
                                minute: '2-digit'
                            });
                            
                            suggestionItem.innerHTML = `
                                <div class="suggestion-header">
                                    <div class="suggestion-title">${suggestion.name}</div>
                                    <div class="suggestion-field">${suggestion.field}</div>
                                </div>
                                
                                <div class="suggestion-content">
                                    <div class="suggestion-detail">
                                        <span class="suggestion-label">الوصف:</span>
                                        <span class="suggestion-value">${suggestion.description}</span>
                                    </div>
                                    
                                    <div class="suggestion-detail">
                                        <span class="suggestion-label">الموقع:</span>
                                        <span class="suggestion-value">${suggestion.location}</span>
                                    </div>
                                    
                                    ${suggestion.website ? `
                                    <div class="suggestion-detail">
                                        <span class="suggestion-label">الموقع الإلكتروني:</span>
                                        <a href="${suggestion.website}" target="_blank" class="suggestion-value suggestion-website">
                                            ${suggestion.website}
                                        </a>
                                    </div>
                                    ` : ''}
                                    
                                    <div class="suggestion-status status-${suggestion.status || 'pending'}">
                                        <i class="fas fa-${suggestion.status === 'approved' ? 'check-circle' : 
                                          suggestion.status === 'rejected' ? 'times-circle' : 'clock'}"></i>
                                        ${suggestion.status === 'approved' ? 'تمت الموافقة' : 
                                          suggestion.status === 'rejected' ? 'مرفوض' : 'قيد المراجعة'}
                                    </div>
                                    
                                    <div class="suggestion-date">
                                        <i class="far fa-clock"></i> ${formattedDate}
                                    </div>
                                </div>
                            `;
                            
                            suggestionsList.appendChild(suggestionItem);
                        });
                    })
                    .catch((error) => {
                        console.error("Error loading suggestions: ", error);
                        suggestionsList.innerHTML = `
                            <div class="error-loading">
                                <i class="fas fa-exclamation-triangle"></i>
                                <p>فشل في تحميل الاقتراحات</p>
                                <p>${error.message}</p>
                            </div>
                        `;
                    });
            }
            
            // الاستماع للتحديثات في الوقت الحقيقي للاقتراحات
            function setupSuggestionsRealtime() {
                try {
                    const suggestionsRef = database.ref('suggestions');
                    suggestionsRef.on('value', (snapshot) => {
                        // إذا كانت نافذة الاقتراحات مفتوحة، قم بتحديث القائمة
                        if (document.getElementById('suggestions-modal').classList.contains('active')) {
                            loadSuggestions();
                        }
                    });
                } catch (error) {
                    console.error('Error setting up realtime suggestions:', error);
                }
            }
            
            // معالجة تقديم النموذج
            document.querySelector('.suggestion-form').addEventListener('submit', function(e) {
                e.preventDefault();
                
                // جمع بيانات النموذج
                const companyData = {
                    name: document.getElementById('company-name').value,
                    field: document.getElementById('company-field').value,
                    description: document.getElementById('company-description').value,
                    location: document.getElementById('company-location').value,
                    website: document.getElementById('company-website').value || '',
                    timestamp: new Date().toISOString(),
                    status: 'pending'
                };
                
                // التحقق من الحقول المطلوبة
                if (!companyData.name || !companyData.field || !companyData.description || !companyData.location) {
                    showNotification('خطأ في الإدخال', 'الرجاء تعبئة جميع الحقول المطلوبة');
                    return;
                }
                
                // إظهار رسالة تحميل
                const submitBtn = document.querySelector('.suggestion-form .submit-btn');
                const originalBtnText = submitBtn.innerHTML;
                submitBtn.innerHTML = '<i class="fas fa-spinner fa-spin"></i> جاري الإرسال...';
                submitBtn.disabled = true;
                
                // حفظ الاقتراح في Firebase
                const suggestionsRef = database.ref('suggestions');
                suggestionsRef.push(companyData)
                    .then(() => {
                        // استعادة حالة الزر
                        submitBtn.innerHTML = originalBtnText;
                        submitBtn.disabled = false;
                        
                        // إظهار رسالة نجاح
                        showNotification('شكراً لك!', 'تم استلام اقتراحك بنجاح وسيتم دراسته من قبل فريقنا');
                        
                        // إغلاق النافذة المنبثقة
                        document.getElementById('suggest-company-modal').classList.remove('active');
                    })
                    .catch((error) => {
                        console.error("Error saving suggestion: ", error);
                        // استعادة حالة الزر
                        submitBtn.innerHTML = originalBtnText;
                        submitBtn.disabled = false;
                        showNotification('خطأ في النظام', 'فشل في إرسال الاقتراح، يرجى المحاولة لاحقاً');
                    });
            });
    
            licenseBtn.addEventListener('click', async function() {
                const enteredKey = licenseInput.value.trim();
                
                if (!enteredKey) {
                    showNotification('خطأ في الإدخال', 'يرجى إدخال مفتاح الترخيص');
                    return;
                }
                
                // إظهار رسالة تحميل
                licenseStatus.innerHTML = '<span><i class="fas fa-spinner fa-spin"></i> جاري التحقق من الترخيص...</span>';
                
                try {
                    const isValid = await verifyLicenseKey(enteredKey);
                    
                    if (isValid) {
                        licenseActive = true;
                        saveLicenseStatus(); // حفظ حالة الترخيص
                        licenseInput.value = ''; // مسح الحقل بعد التفعيل الناجح
                        showNotification('تم التفعيل بنجاح!', 'تم تفعيل الترخيص بنجاح');
                    } else {
                        licenseActive = false;
                        showNotification('خطأ في الترخيص', 'مفتاح الترخيص غير صحيح');
                    }
                } catch (error) {
                    console.error("License verification error:", error);
                    licenseActive = false;
                    showNotification('خطأ في النظام', 'فشل التحقق من الترخيص، يرجى المحاولة لاحقاً');
                }
                
                updateLicenseUI();
            });    
            
            // وظيفة لتحميل البيانات من localStorage أولاً ثم Firebase
            async function loadData() {
                try {
                    // محاولة تحميل البيانات من localStorage أولاً
                    const localData = localStorage.getItem('innovationMapData');
                    if (localData) {
                        try {
                            const parsedData = JSON.parse(localData);
                            sectionDatabase = parsedData.data || parsedData; // دعم التنسيق القديم والجديد
                            ensureAllSectionsExist();
                            console.log('تم تحميل البيانات من التخزين المحلي');
                            
                            // تحديث وقت آخر حفظ إذا كان متوفراً
                            if (parsedData.timestamp) {
                                const saveDate = new Date(parsedData.timestamp);
                                lastSaveTimeElement.textContent = saveDate.toLocaleTimeString('ar-SA');
                            }
                        } catch (error) {
                            console.error('خطأ في تحليل البيانات المحلية:', error);
                            initializeDatabase();
                        }
                    } else {
                        // إذا لم توجد بيانات محلية، حاول تحميل من Firebase
                        try {
                            const snapshot = await database.ref('innovationMapData').once('value');
                            if (snapshot.exists()) {
                                sectionDatabase = snapshot.val();
                                ensureAllSectionsExist();
                                // حفظ البيانات محلياً كنسخة احتياطية
                                saveDataLocally();
                                console.log('تم تحميل البيانات من Firebase');
                            } else {
                                initializeDatabase();
                                console.log('تم إنشاء بيانات جديدة');
                            }
                        } catch (firebaseError) {
                            console.error('خطأ في تحميل البيانات من Firebase:', firebaseError);
                            initializeDatabase();
                        }
                    }
                    
                    return true;
                } catch (error) {
                    console.error("خطأ عام في تحميل البيانات:", error);
                    initializeDatabase();
                    return false;
                }
            }
            
            // تأكد من وجود جميع الأقسام في قاعدة البيانات
            function ensureAllSectionsExist() {
                let hasChanges = false;
                sectors.forEach(sector => {
                    sector.subsections.forEach(subsection => {
                        if (!sectionDatabase[subsection]) {
                            // إذا كان القسم مفقودًا، قم بإنشائه
                            sectionDatabase[subsection] = {
                                sectionNames: Array.from({length: sectionCount}, (_, i) => `القسم ${i+1}`),
                                sectionLinks: Array(sectionCount).fill(''),
                                sectorColor: sector.color
                            };
                            hasChanges = true;
                        }
                    });
                });
                
                if (hasChanges) {
                    saveData(); // حفظ التغييرات إذا تم إضافة أقسام جديدة
                }
            }
            
            // حفظ البيانات محلياً مع timestamp
            function saveDataLocally() {
                try {
                    const dataToSave = {
                        data: sectionDatabase,
                        timestamp: Date.now(),
                        version: '1.0'
                    };
                    localStorage.setItem('innovationMapData', JSON.stringify(dataToSave));
                    updateLastSaveTime();
                    console.log('تم حفظ البيانات محلياً');
                    return true;
                } catch (error) {
                    console.error('خطأ في الحفظ المحلي:', error);
                    return false;
                }
            }
            
            // وظيفة لحفظ البيانات في Firebase و localStorage
            async function saveData() {
                try {
                    // حفظ محلي أولاً (أسرع وأكثر موثوقية)
                    const localSaved = saveDataLocally();
                    
                    // محاولة حفظ في Firebase
                    try {
                        await database.ref('innovationMapData').set(sectionDatabase);
                        console.log('تم حفظ البيانات في Firebase');
                        return true;
                    } catch (firebaseError) {
                        console.error("خطأ في حفظ البيانات في Firebase:", firebaseError);
                        // إذا فشل Firebase، على الأقل البيانات محفوظة محلياً
                        if (localSaved) {
                            showNotification('تم الحفظ محلياً', 'تم حفظ البيانات في التخزين المحلي فقط');
                            return true;
                        }
                        return false;
                    }
                } catch (error) {
                    console.error("خطأ عام في حفظ البيانات:", error);
                    return false;
                }
            }
            
            // وظيفة للاستماع للتحديثات في الوقت الحقيقي (اختيارية)
            function setupRealtimeUpdates() {
                try {
                    database.ref('innovationMapData').on('value', (snapshot) => {
                        if (snapshot.exists()) {
                            const firebaseData = snapshot.val();
                            // تحقق من أن البيانات مختلفة قبل التحديث
                            if (JSON.stringify(firebaseData) !== JSON.stringify(sectionDatabase)) {
                                sectionDatabase = firebaseData;
                                ensureAllSectionsExist();
                                
                                // تحديث العرض إذا لزم الأمر
                                if (activeSection) {
                                    const sectorColor = sectionDatabase[activeSection]?.sectorColor || "#4ca1af";
                                    createNewCircleMap(activeSection, sectorColor);
                                } else {
                                    drawMap();
                                }
                                
                                // حفظ البيانات المحدثة محلياً
                                saveDataLocally();
                                console.log('تم تحديث البيانات من Firebase');
                            }
                        }
                    });
                } catch (error) {
                    console.error('خطأ في إعداد التحديثات المباشرة:', error);
                }
            }
            
            function initializeDatabase() {
                sectors.forEach(sector => {
                    sector.subsections.forEach(subsection => {
                        sectionDatabase[subsection] = {
                            sectionNames: Array.from({length: sectionCount}, (_, i) => `القسم ${i+1}`),
                            sectionLinks: Array(sectionCount).fill(''),
                            sectorColor: sector.color
                        };
                    });
                });
                // حفظ البيانات الأولية
                saveData();
            }
            
            function drawMap() {
                svg.selectAll("*").remove();
                rings.forEach(ring => {
                    sectors.forEach(sector => {
                        const startAngle = sector.startAngle + rotationAngle;
                        const endAngle = sector.endAngle + rotationAngle;
                        if (ring.id === 2) {
                            const sectorAngleRange = endAngle - startAngle;
                            const subsectionAngle = sectorAngleRange / sector.subsections.length;
                            for (let i = 0; i < sector.subsections.length; i++) {
                                const subsectionName = sector.subsections[i];
                                const subsectionStartAngle = startAngle + i * subsectionAngle;
                                const subsectionEndAngle = subsectionStartAngle + subsectionAngle;
                                const arcGenerator = d3.arc()
                                    .innerRadius(ring.innerRadius)
                                    .outerRadius(ring.outerRadius)
                                    .startAngle(subsectionStartAngle)
                                    .endAngle(subsectionEndAngle);
                                const path = svg.append("path")
                                    .attr("d", arcGenerator())
                                    .attr("transform", `translate(${centerX}, ${centerY})`)
                                    .attr("fill", sector.color)
                                    .attr("stroke", "white")
                                    .attr("stroke-width", 1)
                                    .attr("opacity", 0.8)
                                    .attr("class", "subsection")
                                    .attr("data-sector", sector.id)
                                    .attr("data-subsection", i)
                                    .on("mouseover", function() {
                                        d3.select(this).attr("opacity", 1);
                                    })
                                    .on("mouseout", function() {
                                        d3.select(this).attr("opacity", 0.8);
                                    });
                                if (nestingLevel === 0) {
                                    path.on("click", function() {
                                        nestingLevel++;  
                                        const sectorColor = sector.color;
                                        createNewCircleMap(subsectionName, sectorColor);
                                    });
                                }
                                const middleAngle = subsectionStartAngle + subsectionAngle / 2;
                                const textRadius = (ring.innerRadius + ring.outerRadius) / 2;
                                const correctedAngle = middleAngle + 4.728;
                                const x = centerX + textRadius * Math.cos(correctedAngle);
                                const y = centerY + textRadius * Math.sin(correctedAngle);
                                let rotation = (middleAngle * 180 / Math.PI) + 89;
                                if (rotation > 90 && rotation < 270) {
                                    rotation += 180;
                                }
                                const g = svg.append("g")
                                    .attr("transform", `translate(${x}, ${y}) rotate(${rotation})`)
                                    .attr("class", "subsection-label");
                                const labelText = subsectionName;
                                const maxCharsPerLine = 12;
                                let lines = [];
                                if (labelText.length > maxCharsPerLine) {
                                    const words = labelText.split(' ');
                                    let line = "";
                                    words.forEach(word => {
                                        if ((line + word).length <= maxCharsPerLine) {
                                            line += (line ? " " : "") + word;
                                        } else {
                                            lines.push(line);
                                            line = word;
                                        }
                                    });
                                    if (line) lines.push(line);
                                } else {
                                    lines = [labelText];
                                }
                                const lineHeight = 12;
                                const startY = -((lines.length - 1) * lineHeight) / 2;
                                lines.forEach((line, index) => {
                                    g.append("text")
                                        .attr("x", 0)
                                        .attr("y", startY + index * lineHeight)
                                        .attr("text-anchor", "middle")
                                        .attr("dy", "0.35em")
                                        .attr("fill", "#ffffff")
                                        .attr("font-size", "10px")
                                        .attr("font-weight", "bold")
                                        .text(line);
                                });
                            }
                        } else {
                            const arcGenerator = d3.arc()
                                .innerRadius(ring.innerRadius)
                                .outerRadius(ring.outerRadius)
                                .startAngle(startAngle)
                                .endAngle(endAngle);
                            const path = svg.append("path")
                                .attr("d", arcGenerator())
                                .attr("transform", `translate(${centerX}, ${centerY})`)
                                .attr("fill", sector.color)
                                .attr("stroke", "white")
                                .attr("stroke-width", 1)
                                .attr("opacity", 0.8)
                                .attr("class", "sector")
                                .attr("data-sector", sector.id)
                                .on("mouseover", function() {
                                    d3.select(this).attr("opacity", 1);
                                })
                                .on("mouseout", function() {
                                    d3.select(this).attr("opacity", 0.8);
                                });
                        }
                    });
                });
                const innerLabels = [
                    { 
                        lines: ["Regulations and", "Government Support"], 
                        color: "#ffff",
                        angle: Math.PI * 0.5 + rotationAngle
                    },
                    { 
                        lines: ["Ideation Support"],
                        color: "#ffff",
                        angle: Math.PI * 1.7 + rotationAngle
                    },
                    { 
                        lines: ["Networking and", "Cultures"],
                        color: "#ffff",
                        angle: Math.PI * 0.9 + rotationAngle
                    },
                    { 
                        lines: ["Operation, Growth", "and Markets"],
                        color: "#ffff",
                        angle: Math.PI * 0.1 + rotationAngle
                    },
                    { 
                        lines: ["Funding"],
                        color: "#ffff",
                        angle: Math.PI * 3.3 + rotationAngle
                    }
                ];
                const innerRadius = 100;
                innerLabels.forEach((label) => {
                    const x = centerX + innerRadius * Math.cos(label.angle);
                    const y = centerY + innerRadius * Math.sin(label.angle);
                    let rotation = (label.angle * 180 / Math.PI) + 90;
                    if (rotation > 90 && rotation < 270) {
                        rotation += 180;
                    }
                    const g = svg.append("g")
                        .attr("transform", `translate(${x}, ${y}) rotate(${rotation})`)
                        .attr("class", "inner-label");               
     const lineHeight = 15;
                    const startY = -((label.lines.length - 1) * lineHeight) / 2;
                    label.lines.forEach((line, i) => {
                        if (line === "Funding") {
                            g.append("text")
                                .attr("x", 0)
                                .attr("y", startY + i * lineHeight - 4)
                                .attr("text-anchor", "middle")
                                .attr("dy", "0.35em")
                                .attr("fill", label.color)
                                .attr("font-size", "15px")
                                .attr("font-weight", "bold")
                                .text(line);
                        } else {
                            g.append("text")
                                .attr("x", 0)
                                .attr("y", startY + i * lineHeight)
                                .attr("text-anchor", "middle")
                                .attr("dy", "0.35em")
                                .attr("fill", label.color)
                                .attr("font-size", "13px")
                                .attr("font-weight", "bold")
                                .text(line);
                        }
                    });
                });
            }
            
            // دالة إنشاء الدائرة الفرعية مع تأثيرات الانتقال
            function createNewCircleMap(subsectionName, sectorColor) {
               const transitionOverlay = document.getElementById('transition-overlay');
               // transitionOverlay.classList.add('active');
                
                // تطبيق تأثير التصغير على الخريطة الحالية
                const concentricMap = document.getElementById('concentric-map');
                concentricMap.classList.add('zoom-out');
                
                // الانتظار حتى يكتمل تأثير التصغير
                setTimeout(() => {
                    // إزالة الخريطة الحالية
                    svg.selectAll("*").remove();
                    
                    // تحديث مركز الدائرة
                    document.querySelector('.center-circle').innerHTML = `
                        <h3>${subsectionName}</h3>
                    `;
                    
                    // تطبيق تأثير التكبير للخريطة الجديدة
                    concentricMap.classList.remove('zoom-out');
                    concentricMap.classList.add('zoom-in');
                    
                    // إنشاء الخريطة الفرعية الجديدة
                    const currentData = sectionDatabase[subsectionName];    
                    if (!currentData) {
                        const parentSector = sectors.find(sector => 
                            sector.subsections.includes(subsectionName)
                        );
                        sectionDatabase[subsectionName] = {
                            sectionNames: Array.from({length: sectionCount}, (_, i) => `القسم ${i+1}`),
                            sectionLinks: Array(sectionCount).fill(''),
                            sectorColor: parentSector ? parentSector.color : "#4ca1af"
                        }; 
                        saveData();
                    }
                    
                    const sectionNames = sectionDatabase[subsectionName].sectionNames;
                    const sectionLinks = sectionDatabase[subsectionName].sectionLinks;
                    
                    // تحديد عدد الحلقات المطلوبة بناءً على عدد الأقسام
                    // إعداد الحد الأدنى لعدد الأقسام في الحلقة الأولى
                    const baseSectionsPerRing = 20;
                    
                    // حساب عدد الحلقات المطلوبة بشكل ديناميكي
                    let remainingSections = sectionNames.length;
                    let dynamicRingCounts = [];
                    let currentRing = 0;
                    
                    while (remainingSections > 0) {
                        const sectionsThisRing = baseSectionsPerRing + currentRing * 60;
                        dynamicRingCounts.push(sectionsThisRing);
                        remainingSections -= sectionsThisRing;
                        currentRing++;
                    }
                    const ringThickness = 350;
                    
                    // إنشاء الحلقات
                    let sectionIndexGlobal = 0;
                    
                    for (let ringIndex = 0; ringIndex < dynamicRingCounts.length; ringIndex++) {
                        const sectionsInThisRing = dynamicRingCounts[ringIndex];
                    
                        const startIndex = sectionIndexGlobal;
                        const endIndex = Math.min(startIndex + sectionsInThisRing, sectionNames.length);
                        const actualSections = endIndex - startIndex;
                    
                        if (actualSections === 0) break;
                        sectionIndexGlobal += actualSections;
                    
                        const ringInnerRadius = 75 + ringIndex * 140;
                        const ringOuterRadius = ringInnerRadius + 140;
                    
                        if (ringIndex > 0) {
                            // رسم حلقة التحديد
                            svg.append("circle")
                                .attr("cx", centerX)
                                .attr("cy", centerY)
                                .attr("r", ringOuterRadius + 5)
                                .attr("fill", "none")
                              //  .attr("stroke", "#ffd166")
                                .attr("stroke-width", 2)
                               // .attr("stroke-dasharray", "5,5")
                                .attr("class", "ring-highlight")
                                .attr("opacity", 0.7);
                            
                        
                        }
                    
                        const sectorAngle = (2 * Math.PI) / actualSections;
                    
                        for (let i = 0; i < actualSections; i++) {
                            const sectionIndex = startIndex + i;
                            const startAngle = i * sectorAngle;
                            const endAngle = (i + 1) * sectorAngle;
                            
                            const arcGenerator = d3.arc()
                                .innerRadius(ringInnerRadius)
                                .outerRadius(ringOuterRadius)
                                .startAngle(startAngle)
                                .endAngle(endAngle);
                            
                            const path = svg.append("path")
                                .attr("d", arcGenerator())
                                .attr("transform", `translate(${centerX}, ${centerY})`)
                                .attr("fill", sectorColor)
                                .attr("stroke", "white")
                                .attr("stroke-width", 1)
                                .attr("opacity", 0.8)
                                .attr("class", "subsection-item")
                                .attr("data-section", sectionIndex)
                                .on("mouseover", function() {
                                    d3.select(this).attr("opacity", 1);
                                })
                                .on("mouseout", function() {
                                    d3.select(this).attr("opacity", 0.8);
                                });
                            
                            if (sectionLinks[sectionIndex]) {
                                path.on("click", function() {
                                    window.open(sectionLinks[sectionIndex], '_blank');
                                });
                            }
                    
                            const middleAngle = startAngle + sectorAngle / 2;
                            const textRadius = ringInnerRadius + (ringOuterRadius - ringInnerRadius) / 2;
                            const correctedAngle = middleAngle + 4.728;
                            const x = centerX + textRadius * Math.cos(correctedAngle);
                            const y = centerY + textRadius * Math.sin(correctedAngle);
                            
                            let rotation = (middleAngle * 180 / Math.PI) + 90;
                            if (rotation > 90 && rotation < 270) {
                                rotation += 180;
                            }
                            
                            const g = svg.append("g")
                                .attr("transform", `translate(${x}, ${y}) rotate(${rotation})`)
                                .attr("class", "subsection-label");
                            
                            const text = g.append("text")
                                .attr("x", 0)
                                .attr("y", 0)
                                .attr("text-anchor", "middle")
                                .attr("dy", "0.35em")
                                .attr("font-size", ringIndex > 0 ? "8px" : "9px")
                                .attr("font-weight", "bold")
                                .text(sectionNames[sectionIndex]);
                            
                            if (sectionLinks[sectionIndex]) {
                                text.attr("fill", "#ffd166")
                                    .attr("class", "clickable-text")
                                    .on("click", function() {
                                        window.open(sectionLinks[sectionIndex], '_blank');
                                    });
                            } else {
                                text.attr("fill", "#ffffff");
                            }
                        }
                    }
                    
                    svg.append("circle")
                        .attr("cx", centerX)
                        .attr("cy", centerY)
                        .attr("r", 50)
                        .attr("fill", "none")
                        .attr("stroke", "rgba(255, 255, 255, 0.2)")
                        .attr("stroke-dasharray", "5,5")
                        .attr("stroke-width", 1);
                    
                    activeSection = subsectionName;
                    
                    // إخفاء شاشة الانتقال بعد انتهاء التأثير
                    setTimeout(() => {
                        concentricMap.classList.remove('zoom-in');
                        transitionOverlay.classList.remove('active');
                    }, 500);
                }, 800);
            }
            
            // دالة العودة إلى الخريطة الرئيسية مع تأثيرات الانتقال
            function transitionBackToMain() {
                const transitionOverlay = document.getElementById('transition-overlay');
              //  transitionOverlay.classList.add('active');
                
                // تطبيق تأثير التصغير على الخريطة الحالية
                const concentricMap = document.getElementById('concentric-map');
                concentricMap.classList.add('zoom-out');
                
                // الانتظار حتى يكتمل تأثير التصغير
                setTimeout(() => {
                    // إزالة الخريطة الحالية
                    svg.selectAll("*").remove();
                    
                    // تحديث مركز الدائرة
                    document.querySelector('.center-circle').innerHTML = `
                        <h3>سوريا</h3>
                        <p>المركز الرئيسي</p>
                    `;
                    
                    // تطبيق تأثير التكبير للخريطة الرئيسية
                    concentricMap.classList.remove('zoom-out');
                    concentricMap.classList.add('zoom-in');
                    
                    // إنشاء الخريطة الرئيسية
                    nestingLevel = 0;
                    rotationAngle = 0;
                    drawMap();
                    document.getElementById('rotation-controls').style.display = 'flex';
                    activeSection = null;
                    
                    // إخفاء شاشة الانتقال بعد انتهاء التأثير
                    setTimeout(() => {
                        concentricMap.classList.remove('zoom-in');
                        transitionOverlay.classList.remove('active');
                    }, 500);
                }, 800);
            }
            
            // تحميل البيانات وحالة الترخيص عند بدء التطبيق
            loadLicenseStatus();
            await loadData();
            setupRealtimeUpdates();
            setupSuggestionsRealtime(); // إضافة الاستماع للاقتراحات
            setupModalEvents(); // إضافة ربط الأحداث عند التحميل
            updateLicenseUI();
            drawMap();
            
            // حفظ البيانات عند إغلاق النافذة أو تغيير الصفحة
            window.addEventListener('beforeunload', function() {
                saveDataLocally(); // حفظ سريع محلي
            });
            
            // حفظ دوري كل 30 ثانية
            setInterval(() => {
                if (Object.keys(sectionDatabase).length > 0) {
                    saveDataLocally();
                }
            }, 30000);
            
            document.querySelector('.center-circle').addEventListener('click', function() {
                transitionBackToMain();
            });
            document.getElementById('reset-view').addEventListener('click', function() {
                transitionBackToMain();
            });
            document.getElementById('rotate-left').addEventListener('click', function() {
                rotationAngle -= Math.PI/4;
                drawMap();
            });
            
            document.getElementById('rotate-right').addEventListener('click', function() {
                rotationAngle += Math.PI/4;
                drawMap();
            });
            document.getElementById('add-section').addEventListener('click', function() {
                if (!licenseActive) {
                    showNotification('خطأ في الترخيص', 'يجب تفعيل الترخيص أولاً');
                    return;
                }
                if (!activeSection) {
                    showNotification('خطأ', 'يجب اختيار قسم فرعي أولاً');
                    return;
                }
                document.getElementById('add-section-modal').classList.add('active');
                document.getElementById('new-section-name').value = '';
                document.getElementById('section-link').value = '';
                document.getElementById('new-section-name').focus();
            });
            document.getElementById('edit-section').addEventListener('click', function() {
                if (!licenseActive) {
                    showNotification('خطأ في الترخيص', 'يجب تفعيل الترخيص أولاً');
                    return;
                }
                if (!activeSection) {
                    showNotification('خطأ', 'يجب اختيار قسم فرعي أولاً');
                    return;
                }
                updateSectionList();
                document.getElementById('edit-section-modal').classList.add('active');
                document.getElementById('edit-section-content').value = '';
                document.getElementById('edit-section-link').value = '';
                document.querySelectorAll('.section-item').forEach(item => {
                    item.classList.remove('active');
                });
            });
            document.getElementById('close-add-modal').addEventListener('click', function() {
                document.getElementById('add-section-modal').classList.remove('active');
            });
            document.getElementById('cancel-add-btn').addEventListener('click', function() {
                document.getElementById('add-section-modal').classList.remove('active');
            });
            document.getElementById('confirm-add-btn').addEventListener('click', async function() {
                const newName = document.getElementById('new-section-name').value.trim();
                const newLink = document.getElementById('section-link').value.trim();
                if (newName) {
                    if (!sectionDatabase[activeSection]) {
                        sectionDatabase[activeSection] = {
                            sectionNames: [],
                            sectionLinks: [],
                            sectorColor: "#4ca1af"
                        };
                    }
                    sectionDatabase[activeSection].sectionNames.push(newName);
                    sectionDatabase[activeSection].sectionLinks.push(newLink);
                    if (activeSection) {
                        // الحصول على لون القطاع الأصلي من قاعدة البيانات
                        const sectorColor = sectionDatabase[activeSection].sectorColor;
                        // حفظ البيانات
                        const saved = await saveData();
                        if (saved) {
                            createNewCircleMap(activeSection, sectorColor);
                            showNotification('تمت الإضافة بنجاح!', `تم إضافة قسم جديد باسم: ${newName}`);
                        } else {
                            showNotification('خطأ في الحفظ', 'فشل في حفظ القسم الجديد');
                        }
                    }
                    document.getElementById('add-section-modal').classList.remove('active');
                } else {
                    alert('الرجاء إدخال اسم للقسم الجديد');
                }
            });
            document.getElementById('close-edit-modal').addEventListener('click', function() {
                document.getElementById('edit-section-modal').classList.remove('active');
            });
            document.getElementById('cancel-edit-btn').addEventListener('click', function() {
                document.getElementById('edit-section-modal').classList.remove('active');
            });
            document.getElementById('confirm-edit-btn').addEventListener('click', async function() {
                const selectedItem = document.querySelector('.section-item.active');
                const newName = document.getElementById('edit-section-content').value.trim();
                const newLink = document.getElementById('edit-section-link').value.trim();
                if (!selectedItem) {
                    alert('الرجاء تحديد قسم للتعديل');
                    return;
                }
                if (!newName) {
                    alert('الرجاء إدخال اسم جديد للقسم');
                    return;
                }
                const sectionId = parseInt(selectedItem.dataset.id);
                sectionDatabase[activeSection].sectionNames[sectionId] = newName;
                sectionDatabase[activeSection].sectionLinks[sectionId] = newLink;
                if (activeSection) {
                    // الحصول على لون القطاع الأصلي من قاعدة البيانات
                    const sectorColor = sectionDatabase[activeSection].sectorColor;
                    // حفظ البيانات
                    const saved = await saveData();
                    if (saved) {
                        createNewCircleMap(activeSection, sectorColor);
                        showNotification('تم التعديل بنجاح!', `تم تحديث القسم رقم ${sectionId + 1} بنجاح`);
                    } else {
                        showNotification('خطأ في الحفظ', 'فشل في حفظ التعديلات');
                    }
                }
                document.getElementById('edit-section-modal').classList.remove('active');
            });
            function showNotification(title, message) {
                const notification = document.getElementById('notification');
                const titleElement = document.getElementById('notification-title');
                const messageElement = document.getElementById('notification-message');
                titleElement.textContent = title;
                messageElement.textContent = message;
                notification.style.display = 'block';
                setTimeout(() => {
                    notification.style.display = 'none';
                }, 3000);
            }
            function updateSectionList() {
                const sectionList = document.getElementById('section-list');
                sectionList.innerHTML = '';
                if (!activeSection) return;
                const sectionNames = sectionDatabase[activeSection].sectionNames;
                const sectionLinks = sectionDatabase[activeSection].sectionLinks;
                sectionNames.forEach((name, index) => {
                    const sectionItem = document.createElement('div');
                    sectionItem.className = 'section-item';
                    sectionItem.dataset.id = index;
                    sectionItem.innerHTML = `
                        <div>
                            <span class="section-name">${name}</span>
                            ${sectionLinks[index] ? 
                                `<span class="section-link"><i class="fas fa-link link-icon"></i> ${sectionLinks[index]}</span>` : 
                                ''}
                        </div>
                        <span class="section-id">${index + 1}</span>
                    `;
                    sectionItem.addEventListener('click', function() {
                        document.querySelectorAll('.section-item').forEach(item => {
                            item.classList.remove('active');
                        });
                        this.classList.add('active');
                        document.getElementById('edit-section-content').value = name;
                        document.getElementById('edit-section-link').value = sectionLinks[index] || '';
                    });
                    sectionList.appendChild(sectionItem);   });
            }
        });
    </script>
</body>
</html>
